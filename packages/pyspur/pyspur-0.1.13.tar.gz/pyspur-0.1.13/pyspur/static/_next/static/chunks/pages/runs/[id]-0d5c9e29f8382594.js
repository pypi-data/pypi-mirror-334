(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5876],{49820:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/runs/[id]",function(){return s(14734)}])},14734:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>U});var a=s(74848),l=s(81924),n=s(29080),r=s(14516),i=s(69231),c=s(23825),u=s(22424),d=s(33016),o=s(15445),x=s(98536),m=s(72764),h=s(49517),f=s(21005),j=s(97080),p=s(72748),N=s(37399),g=s(7772),v=s(11879),w=s(90657),y=s(86715),_=s(96540),E=s(7064);let C=e=>{switch(e){case"COMPLETED":return"success";case"RUNNING":case"PENDING":case"PAUSED":return"warning";case"FAILED":case"CANCELLED":return"danger";default:return"default"}},D=e=>{switch(e){case"COMPLETED":return"solar:check-circle-linear";case"RUNNING":return"solar:running-linear";case"PENDING":return"solar:clock-circle-linear";case"PAUSED":return"solar:pause-circle-linear";case"FAILED":return"solar:danger-circle-linear";case"CANCELLED":return"solar:close-circle-linear";default:return"solar:question-circle-linear"}},b=_.memo(e=>{let{runs:t,isLoading:s,handleRunClick:l}=e,m=(e,t)=>{if(!e)return"-";let s=e.endsWith("Z")?e:e+"Z",a=(0,g.H)(s),l=t?t.endsWith("Z")?t:t+"Z":void 0,n=((l?(0,g.H)(l):new Date).getTime()-a.getTime())/1e3;if(n<60)return"".concat(Math.round(n),"s");if(n<3600)return"".concat(Math.floor(n/60),"m ").concat(Math.round(n%60),"s");{let e=Math.floor(n/3600),t=Math.floor(n%3600/60);return"".concat(e,"h ").concat(t,"m")}},h=e=>{let t=e.endsWith("Z")?e:e+"Z",s=(0,g.H)(t);return(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:(0,v.GP)(s,"MMM d, yyyy HH:mm:ss 'UTC'")}),(0,a.jsx)("span",{className:"text-xs text-default-400",children:(0,w.m)(s,{addSuffix:!0})})]})};return s?(0,a.jsx)("div",{className:"flex justify-center p-4",children:(0,a.jsx)(n.o,{size:"lg"})}):0===t.length?(0,a.jsx)("div",{className:"flex justify-center p-8 text-default-500",children:"No runs found for this spur"}):(0,a.jsxs)(r.j,{"aria-label":"Spur Runs",isHeaderSticky:!0,children:[(0,a.jsx)(i.X,{columns:[{key:"run_id",label:"Run ID"},{key:"time",label:"Time (UTC)"},{key:"inputs",label:"Inputs"},{key:"duration",label:"Duration"},{key:"status",label:"Status"}],children:e=>(0,a.jsx)(c.e,{children:e.label},e.key)}),(0,a.jsx)(u.E,{items:t,children:e=>(0,a.jsx)(d.s,{children:t=>(0,a.jsx)(o.w,{children:"time"===t?e.start_time?h(e.start_time):"-":"inputs"===t?(0,a.jsx)("div",{children:e.initial_inputs?(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsx)(E.A,{output:Object.values(e.initial_inputs)[0]||{},maxHeight:"100px"})}):(0,a.jsx)("span",{className:"text-default-400",children:"No inputs"})}):"run_id"===t?(0,a.jsx)(x.R,{size:"sm",variant:"flat",className:"cursor-pointer",onClick:()=>l(e.id),children:e.id}):"duration"===t?(0,a.jsx)("span",{children:m(e.start_time,e.end_time)}):"status"===t?(0,a.jsx)(x.R,{size:"sm",variant:"flat",color:C(e.status),startContent:(0,a.jsx)(N.In,{icon:D(e.status),width:16}),children:e.status}):null})},e.id)})]})});b.displayName="RunsTable";let S=e=>{let{workflowId:t}=e;(0,y.useRouter)();let[s,n]=(0,_.useState)([]),[r,i]=(0,_.useState)(!0),[c,u]=(0,_.useState)(null),[d,o]=(0,_.useState)(null),[x,g]=(0,_.useState)("00:00"),[v,w]=(0,_.useState)("23:59"),[E,C]=(0,_.useState)("100"),[D,S]=(0,_.useState)(1),[k,T]=(0,_.useState)(!0),[I,P]=(0,_.useState)(!1),M=(e,t)=>{let[s,a]=t.split(":").map(Number);return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),s,a))},R=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let s,a;let r=e?D+1:1;i(!e),e&&P(!0),c&&(s=M(new Date(c.toString()),x)),d&&(a=M(new Date(d.toString()),v));let u=await (0,l.ML)(t,r,parseInt(E),s,a),o=u.sort((e,t)=>{let s=e.start_time?new Date(e.start_time.endsWith("Z")?e.start_time:e.start_time+"Z").getTime():0;return(t.start_time?new Date(t.start_time.endsWith("Z")?t.start_time:t.start_time+"Z").getTime():0)-s});e?n(e=>[...e,...o]):n(o),S(r),T(u.length===parseInt(E))}catch(e){console.error("Error fetching workflow runs:",e)}finally{i(!1),P(!1)}};return(0,_.useEffect)(()=>{R();let e=setInterval(()=>{s.some(e=>"RUNNING"===e.status||"PENDING"===e.status||"PAUSED"===e.status)&&R()},5e3);return()=>clearInterval(e)},[t,c,d,x,v,E]),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-default-600",children:"Start Date (UTC)"}),(0,a.jsx)(m.g,{value:c,onChange:u,labelPlacement:"outside",classNames:{base:"min-w-[200px]",input:"min-w-[200px]"}})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-default-600",children:"Start Time (UTC)"}),(0,a.jsx)(h.r,{type:"time",value:x,onChange:e=>g(e.target.value),className:"min-w-[150px]"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-default-600",children:"End Date (UTC)"}),(0,a.jsx)(m.g,{value:d,onChange:o,labelPlacement:"outside",classNames:{base:"min-w-[200px]",input:"min-w-[200px]"}})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-default-600",children:"End Time (UTC)"}),(0,a.jsx)(h.r,{type:"time",value:v,onChange:e=>w(e.target.value),className:"min-w-[150px]"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-default-600",children:"Number of Runs"}),(0,a.jsxs)(f.d,{value:E,onChange:e=>C(e.target.value),className:"min-w-[120px]",children:[(0,a.jsx)(j.y,{value:"10",children:"10 runs"},"10"),(0,a.jsx)(j.y,{value:"20",children:"20 runs"},"20"),(0,a.jsx)(j.y,{value:"100",children:"100 runs"},"100"),(0,a.jsx)(j.y,{value:"200",children:"200 runs"},"200")]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p.T,{color:"primary",onClick:()=>{S(1),R()},children:"Apply Filter"}),(0,a.jsx)(p.T,{variant:"flat",onClick:()=>{u(null),o(null),g("00:00"),w("23:59"),C("100"),S(1)},children:"Clear"})]})]}),(0,a.jsx)(b,{runs:s,isLoading:r,handleRunClick:e=>{window.open("/trace/".concat(e),"_blank")}}),k&&(0,a.jsx)("div",{className:"flex justify-center mt-4",children:(0,a.jsx)(p.T,{variant:"flat",onPress:()=>{R(!0)},isLoading:I,startContent:!I&&(0,a.jsx)(N.In,{icon:"lucide:plus",width:16}),children:I?"Loading...":"Load More"})})]})};var k=s(29838),T=s(13368),I=s.n(T),P=s(71468),M=s(68131),R=s(8640),L=s(73232);let U=()=>{let{id:e}=(0,y.useRouter)().query,[t,s]=(0,_.useState)(""),[r,i]=(0,_.useState)(!0),c=(0,P.wA)();return((0,_.useEffect)(()=>{let t=async()=>{if("string"==typeof e)try{let t=await (0,l.Mw)(e);s(t.name),c((0,k.XK)(t.name))}catch(e){console.error("Error fetching workflow:",e)}finally{i(!1)}};e&&t()},[e]),e&&"string"==typeof e)?r?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(n.o,{size:"lg"})}):(0,a.jsxs)(M.Q,{loading:null,persistor:L.q,children:[(0,a.jsx)(I(),{children:(0,a.jsx)("title",{children:t?"".concat(t," - Runs"):"Spur Runs"})}),(0,a.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:[(0,a.jsx)(R.A,{activePage:"runs",associatedWorkflowId:e}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6 flex-grow",children:(0,a.jsx)(S,{workflowId:e})})]})]}):(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("div",{className:"text-default-500",children:"Invalid workflow ID"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[7998,8872,8660,4486,7354,453,3427,2327,6743,657,2823,8640,7064,636,6593,8792],()=>t(49820)),_N_E=e.O()}]);