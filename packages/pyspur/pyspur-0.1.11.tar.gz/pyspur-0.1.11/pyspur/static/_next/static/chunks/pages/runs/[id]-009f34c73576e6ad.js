(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5876],{49820:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/runs/[id]",function(){return t(14734)}])},14734:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>M});var l=t(74848),a=t(81924),r=t(29080),n=t(14516),i=t(69231),c=t(23825),u=t(22424),d=t(33016),x=t(15445),o=t(98536),m=t(72764),h=t(49517),f=t(21005),j=t(97080),N=t(72748),p=t(37399),g=t(7772),v=t(11879),w=t(90657),y=t(86715),E=t(96540),C=t(7064);let D=e=>{switch(e){case"COMPLETED":return"success";case"RUNNING":case"PENDING":case"PAUSED":return"warning";case"FAILED":case"CANCELLED":return"danger";default:return"default"}},b=e=>{switch(e){case"COMPLETED":return"solar:check-circle-linear";case"RUNNING":return"solar:running-linear";case"PENDING":return"solar:clock-circle-linear";case"PAUSED":return"solar:pause-circle-linear";case"FAILED":return"solar:danger-circle-linear";case"CANCELLED":return"solar:close-circle-linear";default:return"solar:question-circle-linear"}},_=E.memo(e=>{let{runs:s,isLoading:t,handleRunClick:a}=e,m=(e,s)=>{if(!e)return"-";let t=(0,g.H)(e),l=((s?(0,g.H)(s):new Date).getTime()-t.getTime())/1e3;if(l<60)return"".concat(Math.round(l),"s");if(l<3600)return"".concat(Math.floor(l/60),"m ").concat(Math.round(l%60),"s");{let e=Math.floor(l/3600),s=Math.floor(l%3600/60);return"".concat(e,"h ").concat(s,"m")}},h=e=>{let s=(0,g.H)(e);return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{children:(0,v.GP)(s,"MMM d, yyyy HH:mm:ss 'UTC'")}),(0,l.jsx)("span",{className:"text-xs text-default-400",children:(0,w.m)(s,{addSuffix:!0})})]})};return t?(0,l.jsx)("div",{className:"flex justify-center p-4",children:(0,l.jsx)(r.o,{size:"lg"})}):0===s.length?(0,l.jsx)("div",{className:"flex justify-center p-8 text-default-500",children:"No runs found for this spur"}):(0,l.jsxs)(n.j,{"aria-label":"Spur Runs",isHeaderSticky:!0,children:[(0,l.jsx)(i.X,{columns:[{key:"run_id",label:"Run ID"},{key:"time",label:"Time (UTC)"},{key:"inputs",label:"Inputs"},{key:"duration",label:"Duration"},{key:"status",label:"Status"}],children:e=>(0,l.jsx)(c.e,{children:e.label},e.key)}),(0,l.jsx)(u.E,{items:s,children:e=>(0,l.jsx)(d.s,{children:s=>(0,l.jsx)(x.w,{children:"time"===s?e.start_time?h(e.start_time):"-":"inputs"===s?(0,l.jsx)("div",{children:e.initial_inputs?(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,l.jsx)(C.A,{output:Object.values(e.initial_inputs)[0]||{},maxHeight:"100px"})}):(0,l.jsx)("span",{className:"text-default-400",children:"No inputs"})}):"run_id"===s?(0,l.jsx)(o.R,{size:"sm",variant:"flat",className:"cursor-pointer",onClick:()=>a(e.id),children:e.id}):"duration"===s?(0,l.jsx)("span",{children:m(e.start_time,e.end_time)}):"status"===s?(0,l.jsx)(o.R,{size:"sm",variant:"flat",color:D(e.status),startContent:(0,l.jsx)(p.In,{icon:b(e.status),width:16}),children:e.status}):null})},e.id)})]})});_.displayName="RunsTable";let k=e=>{let{workflowId:s}=e,t=(0,y.useRouter)(),[r,n]=(0,E.useState)([]),[i,c]=(0,E.useState)(!0),[u,d]=(0,E.useState)(null),[x,o]=(0,E.useState)(null),[p,g]=(0,E.useState)("00:00"),[v,w]=(0,E.useState)("23:59"),[C,D]=(0,E.useState)("100"),b=(e,s)=>{let[t,l]=s.split(":").map(Number);return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),t,l))},k=async()=>{try{let e,t;c(!0),u&&(e=b(new Date(u.toString()),p)),x&&(t=b(new Date(x.toString()),v));let l=(await (0,a.ML)(s,1,parseInt(C),e,t)).sort((e,s)=>{let t=e.start_time?new Date(e.start_time).getTime():0;return(s.start_time?new Date(s.start_time).getTime():0)-t});n(l)}catch(e){console.error("Error fetching workflow runs:",e)}finally{c(!1)}};return(0,E.useEffect)(()=>{k();let e=setInterval(()=>{r.some(e=>"RUNNING"===e.status||"PENDING"===e.status||"PAUSED"===e.status)&&k()},5e3);return()=>clearInterval(e)},[s,u,x,p,v,C]),(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-default-600",children:"Start Date (UTC)"}),(0,l.jsx)(m.g,{value:u,onChange:d,labelPlacement:"outside",classNames:{base:"min-w-[200px]",input:"min-w-[200px]"}})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-default-600",children:"Start Time (UTC)"}),(0,l.jsx)(h.r,{type:"time",value:p,onChange:e=>g(e.target.value),className:"min-w-[150px]"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-default-600",children:"End Date (UTC)"}),(0,l.jsx)(m.g,{value:x,onChange:o,labelPlacement:"outside",classNames:{base:"min-w-[200px]",input:"min-w-[200px]"}})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-default-600",children:"End Time (UTC)"}),(0,l.jsx)(h.r,{type:"time",value:v,onChange:e=>w(e.target.value),className:"min-w-[150px]"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("label",{className:"text-sm text-default-600",children:"Number of Runs"}),(0,l.jsxs)(f.d,{value:C,onChange:e=>D(e.target.value),className:"min-w-[120px]",children:[(0,l.jsx)(j.y,{value:"10",children:"10 runs"},"10"),(0,l.jsx)(j.y,{value:"20",children:"20 runs"},"20"),(0,l.jsx)(j.y,{value:"100",children:"100 runs"},"100"),(0,l.jsx)(j.y,{value:"200",children:"200 runs"},"200")]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(N.T,{color:"primary",onClick:()=>{k()},children:"Apply Filter"}),(0,l.jsx)(N.T,{variant:"flat",onClick:()=>{d(null),o(null),g("00:00"),w("23:59"),D("100")},children:"Clear"})]})]}),(0,l.jsx)(_,{runs:r,isLoading:i,handleRunClick:e=>{t.push("/trace/".concat(e))}})]})};var S=t(13368),T=t.n(S),I=t(68131),R=t(8640),P=t(73232);let M=()=>{let{id:e}=(0,y.useRouter)().query,[s,t]=(0,E.useState)(""),[n,i]=(0,E.useState)(!0);return((0,E.useEffect)(()=>{let s=async()=>{if("string"==typeof e)try{let s=await (0,a.Mw)(e);t(s.name)}catch(e){console.error("Error fetching workflow:",e)}finally{i(!1)}};e&&s()},[e]),e&&"string"==typeof e)?n?(0,l.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,l.jsx)(r.o,{size:"lg"})}):(0,l.jsxs)(I.Q,{loading:null,persistor:P.q,children:[(0,l.jsx)(T(),{children:(0,l.jsx)("title",{children:s?"".concat(s," - Runs"):"Spur Runs"})}),(0,l.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:[(0,l.jsx)(R.A,{activePage:"runs",associatedWorkflowId:e}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6 flex-grow",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-default-900",children:s}),(0,l.jsx)("p",{className:"text-default-500",children:"Run History"})]}),(0,l.jsx)(k,{workflowId:e})]})]})]}):(0,l.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,l.jsx)("div",{className:"text-default-500",children:"Invalid workflow ID"})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[7998,8872,8660,4486,7354,453,3427,2327,6743,657,2823,8640,7064,636,6593,8792],()=>s(49820)),_N_E=e.O()}]);