(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{66968:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/evals",function(){return a(14212)}])},14212:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>B});var l=a(77528),r=a(55456),t=a(74848),i=a(96540),n=a(86715),c=a(78714),d=a(8640),o=a(81924),u=a(59639),h=a(90407),x=a(28624),m=a(13926),j=a(72748),f=a(88344),g=a(83785),b=a(60550),p=a(53171),v=a(50227),N=a(45388),y=a(73486),w=a(69554),E=a(72250),_=a(32172),S=a(85202),k=a(37399);function P(e){let{title:s,description:a,type:n,numSamples:c,paperLink:d,onRun:P}=e,[T,A]=(0,i.useState)(!1),[V,O]=(0,i.useState)([]),[C,D]=(0,i.useState)(null),[F,I]=(0,i.useState)([]),[R,z]=(0,i.useState)(null),[L,W]=(0,i.useState)(1),[B,M]=(0,i.useState)({message:"",color:"default",isVisible:!1}),X=(e,s)=>{M({message:e,color:s,isVisible:!0}),setTimeout(()=>M(e=>(0,r._)((0,l._)({},e),{isVisible:!1})),3e3)};(0,i.useEffect)(()=>{T&&(async()=>{try{let e=await (0,o.bg)();O(e)}catch(e){console.error("Error fetching workflows:",e),X("Failed to load workflows.","danger")}})()},[T]),(0,i.useEffect)(()=>{C&&(async()=>{try{let e=await (0,o.sX)(C.id);I(e)}catch(e){console.error("Error fetching output variables:",e),X("Failed to load output variables.","danger")}})()},[C]);let G=async()=>{if(!C){X("Please select a workflow.","danger");return}if(!R){X("Please select an output variable.","danger");return}try{let e=await (0,o.CB)(C.id,s,R,L);X("Eval run started with ID: ".concat(e.run_id),"success"),A(!1)}catch(e){console.error("Error starting eval run:",e),X("Failed to start eval run.","danger")}};return(0,t.jsxs)(t.Fragment,{children:[B.isVisible&&(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,t.jsx)(u.B,{color:B.color,children:B.message})}),(0,t.jsxs)(h.Z,{className:"relative w-full",children:[(0,t.jsxs)(x.U,{className:"relative min-h-[220px] bg-gradient-to-br from-content1 to-default-100/50 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:s}),(0,t.jsx)("p",{className:"text-default-500 text-sm mb-3",children:a}),(0,t.jsxs)("p",{className:"text-default-500 text-sm mb-1",children:[(0,t.jsx)("strong",{children:"Type:"})," ",n]}),(0,t.jsxs)("p",{className:"text-default-500 text-sm mb-1",children:[(0,t.jsx)("strong",{children:"Num Samples:"})," ",c]}),d&&(0,t.jsx)("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 text-sm",children:"Original Paper"})]}),(0,t.jsx)(m.d,{className:"border-t-1 border-default-100 justify-end py-2 px-4",children:(0,t.jsx)(j.T,{color:"primary",variant:"flat",onPress:()=>A(!0),startContent:(0,t.jsx)(k.In,{icon:"solar:play-linear",width:16}),children:"Run Eval"})})]}),(0,t.jsx)(f.Y,{isOpen:T,onOpenChange:A,children:(0,t.jsx)(g.g,{children:e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.c,{className:"flex flex-col gap-1",children:"Eval Configuration"}),(0,t.jsxs)(p.h,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold mb-2",children:"Select a Workflow"}),(0,t.jsxs)(v.A,{children:[(0,t.jsx)(N.b,{children:(0,t.jsx)(j.T,{variant:"flat",color:"primary",children:C?C.name:"Select a Workflow"})}),(0,t.jsx)(y.y,{"aria-label":"Workflows",onAction:e=>{let s=V.find(s=>s.id===e.toString());s&&(D(s),z(null))},children:V.map(e=>(0,t.jsx)(w.Y,{children:e.name},e.id))})]}),C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold mt-4 mb-2",children:"Select an Output Variable"}),(0,t.jsxs)(v.A,{children:[(0,t.jsx)(N.b,{children:(0,t.jsx)(j.T,{variant:"flat",color:"primary",children:R||"Select an Output Variable"})}),(0,t.jsx)(y.y,{"aria-label":"Output Variables",onAction:e=>z(e.toString()),children:Object.entries(F.reduce((e,s)=>{let{node_id:a,variable_name:l,prefixed_variable:r}=s;return e[a]||(e[a]=[]),e[a].push({variable_name:l,prefixed_variable:r}),e},{})).map(e=>{let[s,a]=e;return(0,t.jsx)(E.g,{title:"Node: ".concat(s),children:a.map(e=>{let{variable_name:s,prefixed_variable:a}=e;return(0,t.jsx)(w.Y,{children:s},a)})},s)})})]})]}),(0,t.jsx)("h3",{className:"text-sm font-semibold mt-4 mb-2",children:"Select Number of Samples"}),(0,t.jsx)(_.Q,{label:"Number of Samples",step:1,maxValue:c,minValue:1,defaultValue:1,value:L,onChange:e=>W(Number(e)),className:"max-w-md"})]}),(0,t.jsxs)(S.q,{children:[(0,t.jsx)(j.T,{color:"danger",variant:"light",onPress:e,children:"Cancel"}),(0,t.jsx)(j.T,{color:"primary",onPress:G,children:"Run Eval"})]})]})})})]})}var T=a(76208),A=a(69231),V=a(23825),O=a(22424),C=a(33016),D=a(15445),F=a(98536),I=a(29080),R=a(17842),z=a(72387),L=a(33036);let W={PENDING:"primary",RUNNING:"warning",COMPLETED:"success",FAILED:"danger"},B=()=>{let[e,s]=(0,i.useState)([]),[a,h]=(0,i.useState)([]),[x,m]=(0,i.useState)(!0),{theme:f}=(0,c.D)(),[g,b]=(0,i.useState)({message:"",color:"default",isVisible:!1}),p=(0,n.useRouter)(),v=(e,s)=>{b({message:e,color:s,isVisible:!0}),setTimeout(()=>b(e=>(0,r._)((0,l._)({},e),{isVisible:!1})),3e3)};(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,o.c6)();s(e)}catch(e){console.error("Error fetching evals:",e),v("Failed to load evals.","danger")}finally{m(!1)}})()},[]),(0,i.useEffect)(()=>{let e=async()=>{try{let e=await (0,o.jb)(),s=await Promise.all(e.map(async e=>{if("COMPLETED"===e.status)try{let s=await (0,o.eW)(e.run_id);return(0,r._)((0,l._)({},e),{results:s.results})}catch(s){console.error("Error fetching results for run ".concat(e.run_id,":"),s)}return e}));h(s)}catch(e){console.error("Error fetching eval runs:",e),v("Failed to load eval runs.","danger")}};e();let s=setInterval(e,5e3);return()=>clearInterval(s)},[]);let N=async(e,s,a,l)=>{if(!e){v("Workflow ID is missing.","danger");return}if(!l){v("Output variable is missing.","danger");return}try{v("Launching eval with output variable: ".concat(l," and ").concat(a," samples..."),"default");let r=await (0,o.CB)(e,s,l,a);v("Eval run started.","success"),h(e=>[...e,r])}catch(e){console.error("Error launching eval:",e),v("Failed to launch eval.","danger")}},y=async e=>{p.push("/evals/".concat(e))};return(0,t.jsxs)("div",{className:"App relative",children:[(0,t.jsx)(d.A,{activePage:"evals"}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mt-8 mb-4",children:"Eval Jobs"}),a.length>0?(0,t.jsxs)(T.j,{"aria-label":"Eval Jobs Table",isHeaderSticky:!0,children:[(0,t.jsxs)(A.X,{children:[(0,t.jsx)(V.e,{children:"Run ID"}),(0,t.jsx)(V.e,{children:"Eval Name"}),(0,t.jsx)(V.e,{children:"Workflow ID"}),(0,t.jsx)(V.e,{children:"Status"}),(0,t.jsx)(V.e,{children:"Accuracy"}),(0,t.jsx)(V.e,{children:"Actions"})]}),(0,t.jsx)(O.E,{items:a,children:e=>(0,t.jsxs)(C.s,{children:[(0,t.jsx)(D.w,{children:e.run_id}),(0,t.jsx)(D.w,{children:e.eval_name}),(0,t.jsx)(D.w,{children:e.workflow_id}),(0,t.jsx)(D.w,{children:(0,t.jsx)(F.R,{className:"capitalize",color:W[e.status],size:"sm",variant:"flat",children:"RUNNING"===e.status?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(I.o,{size:"sm"}),e.status]}):e.status})}),(0,t.jsx)(D.w,{children:e.results&&void 0!==e.results.accuracy?(0,t.jsx)("div",{style:{width:50,height:50},children:(0,t.jsxs)(R.D,{width:50,height:50,cx:25,cy:25,innerRadius:18,outerRadius:25,barSize:7,data:[{name:"Accuracy",value:100*e.results.accuracy}],startAngle:90,endAngle:-270,children:[(0,t.jsx)(z.Z,{dataKey:"value",cornerRadius:12,fill:"dark"===f?"hsl(143 55% 62%)":"hsl(143 55% 42%)",background:{fill:"dark"===f?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}}),(0,t.jsx)(L.r,{type:"number",domain:[0,100],tick:!1}),(0,t.jsx)("text",{x:25,y:25,textAnchor:"middle",dominantBaseline:"middle",style:{fontSize:"11px",fontWeight:"600",fill:"dark"===f?"rgba(255, 255, 255, 0.95)":"rgba(0, 0, 0, 0.9)"},children:"".concat((100*e.results.accuracy).toFixed(1),"%")})]})}):"COMPLETED"===e.status?"N/A":"--"}),(0,t.jsx)(D.w,{children:"COMPLETED"===e.status?(0,t.jsx)(j.T,{size:"sm",onPress:()=>y(e.run_id),children:"View Examples"}):(0,t.jsx)("p",{children:"--"})})]},e.run_id)})]}):(0,t.jsx)("p",{children:"No eval runs available."}),(0,t.jsx)("div",{className:"my-8"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mt-8 mb-4",children:"Available Evals"}),x?(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)(I.o,{size:"lg"})}):e.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,t.jsx)(P,{title:e.name,description:e.description,type:e.type,numSamples:e.num_samples,paperLink:e.paper_link,onRun:(s,a,l)=>N(s,e.name,a,l)},e.name))}):(0,t.jsx)("p",{children:"No evals available."})]}),g.isVisible&&(0,t.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,t.jsx)(u.B,{color:g.color,children:g.message})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[998,872,660,862,453,505,667,963,640,636,593,792],()=>s(66968)),_N_E=e.O()}]);