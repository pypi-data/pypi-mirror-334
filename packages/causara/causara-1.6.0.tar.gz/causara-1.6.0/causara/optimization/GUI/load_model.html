<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>causara</title>
    <link href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Display:wght@400;500;700&display=swap" rel="stylesheet">

    <style>

        *:focus {
            outline: none;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            font-size: 1.0vw;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 40px 60px;
            padding-left: 80px;
            padding-right: 80px;
        }
        .top-bar .left {
            display: flex;
            align-items: center;
        }
        .top-bar .right {
            display: flex;
            align-items: center;
        }

        button {
            font-size: 1.0vw;
            background: #DF6F65;
            color: #fff;
            border-radius: 4px;
            padding: 12px 40px;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background: #db564b;
        }

        .dropdown-container {
            display: flex;
            align-items: center;
        }
        .dropdown-container label {
            margin-right: 30px;
            font-size: 1.0vw;
        }
        select {
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
            width: 400px;
            font-size: 1.0vw;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .dropzone {
            width: 50%;
            height: 50%;
            border: 2px dashed #aaa;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            font-size: 1.0vw;
        }
        .dropzone p {
            font-size: 1.0vw;
            text-align: center;
            margin: 0;
        }

    </style>

    <script>

        document.addEventListener("DOMContentLoaded", function() {
            // Add event listener for model selection
            const dropdown = document.getElementById('onlineModel');
            dropdown.addEventListener('change', function() {
                const selectedModel = dropdown.value;
                if (selectedModel) {
                    pywebview.api.load_online_model(selectedModel)
                        .then(response => {
                            alert(response);
                        })
                        .catch(error => {
                            console.error('Error loading model:', error);
                        });
                }
            });
        });

        function openModelFile() {
            pywebview.api.load_model_with_file_dialog()
                .then(response => {
                    if (response) {
                        alert(response);
                    }
                });

        }

        function handleDragOver(event) {
            event.preventDefault();
        }

        function handleFileDrop(event) {
            event.preventDefault();
            const file = event.dataTransfer.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                // e.target.result will be a base64-encoded data URL if we used readAsDataURL
                const base64DataUrl = e.target.result;

                // Pass it to Python
                pywebview.api.load_local_model(file.name, base64DataUrl)
                .then(response => {
                    if (response) {
                        alert(response);
                    }
                });

            };
            reader.readAsDataURL(file);
        }

    </script>

</head>

<body>
    <div class="top-bar">
        <div class="left">
            <button onclick="openModelFile()">Load model from file</button>
        </div>
        <div class="right">
            <div class="dropdown-container">
                <label for="onlineModel">Load online model</label>
                <select id="onlineModel">
                    <option value="">-- select model --</option>
                </select>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="dropzone"
             ondragover="handleDragOver(event)"
             ondrop="handleFileDrop(event)">
            <p>Drag & Drop your *.causara_model file here</p>
        </div>
    </div>
</body>
</html>
