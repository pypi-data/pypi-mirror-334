
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../websockets/">
      
      
        <link rel="next" href="../services/default_services/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Inyección de dependencias - Cafeto</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#inyeccion-de-dependencias" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../" title="Cafeto" class="md-header__button md-logo" aria-label="Cafeto" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cafeto
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Inyección de dependencias
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../dependency_injection/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/if-geek/cafeto" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    If Geek/Cafeto
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../" title="Cafeto" class="md-nav__button md-logo" aria-label="Cafeto" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cafeto
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/if-geek/cafeto" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    If Geek/Cafeto
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DTO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            DTO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dto/dto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DTO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dto/generic_response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GenericResponse
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../controllers_and_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controladores y acciones
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../request/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Request
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Response
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../params/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parámetros
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../validations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validación
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../access_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control de acceso
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../websockets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Websockets
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Inyección de dependencias
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Inyección de dependencias
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#para-que-sirve" class="md-nav__link">
    <span class="md-ellipsis">
      Para qué sirve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importancia" class="md-nav__link">
    <span class="md-ellipsis">
      Importancia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tipos" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tipos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singleton" class="md-nav__link">
    <span class="md-ellipsis">
      Singleton
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scoped" class="md-nav__link">
    <span class="md-ellipsis">
      Scoped
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transient" class="md-nav__link">
    <span class="md-ellipsis">
      Transient
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integracion" class="md-nav__link">
    <span class="md-ellipsis">
      Integración
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inyeccion-de-dependencias-basada-en-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Inyección de Dependencias Basada en Interfaces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inyección de Dependencias Basada en Interfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#por-que-es-esto-util" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Por qué es esto útil?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inyeccion-de-dependencias-basada-en-clases" class="md-nav__link">
    <span class="md-ellipsis">
      Inyección de Dependencias Basada en Clases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparacion-y-uso-en-python" class="md-nav__link">
    <span class="md-ellipsis">
      Comparación y Uso en Python
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generador-generator" class="md-nav__link">
    <span class="md-ellipsis">
      Generador (Generator)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sobreescribir-override" class="md-nav__link">
    <span class="md-ellipsis">
      Sobreescribir (override)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remover-dependencias" class="md-nav__link">
    <span class="md-ellipsis">
      Remover dependencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inyeccion-de-las-dependencias" class="md-nav__link">
    <span class="md-ellipsis">
      Inyección de las dependencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#informacion-importante" class="md-nav__link">
    <span class="md-ellipsis">
      Información importante
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Información importante">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#por-que-es-importante-esto" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Por qué es importante esto?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusión
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Servicios
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Servicios
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/default_services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Servicios por defecto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AContextService
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../starlette_request_object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Objeto Request de Starlette
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evetos
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenApi y Swagger
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../other/coming_soon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Próximamente
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../other/alternatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alternativas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../other/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Licencia
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sponsor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Patrocinador
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#para-que-sirve" class="md-nav__link">
    <span class="md-ellipsis">
      Para qué sirve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importancia" class="md-nav__link">
    <span class="md-ellipsis">
      Importancia
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tipos" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tipos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singleton" class="md-nav__link">
    <span class="md-ellipsis">
      Singleton
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scoped" class="md-nav__link">
    <span class="md-ellipsis">
      Scoped
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transient" class="md-nav__link">
    <span class="md-ellipsis">
      Transient
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integracion" class="md-nav__link">
    <span class="md-ellipsis">
      Integración
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inyeccion-de-dependencias-basada-en-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Inyección de Dependencias Basada en Interfaces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inyección de Dependencias Basada en Interfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#por-que-es-esto-util" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Por qué es esto útil?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inyeccion-de-dependencias-basada-en-clases" class="md-nav__link">
    <span class="md-ellipsis">
      Inyección de Dependencias Basada en Clases
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparacion-y-uso-en-python" class="md-nav__link">
    <span class="md-ellipsis">
      Comparación y Uso en Python
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generador-generator" class="md-nav__link">
    <span class="md-ellipsis">
      Generador (Generator)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sobreescribir-override" class="md-nav__link">
    <span class="md-ellipsis">
      Sobreescribir (override)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remover-dependencias" class="md-nav__link">
    <span class="md-ellipsis">
      Remover dependencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inyeccion-de-las-dependencias" class="md-nav__link">
    <span class="md-ellipsis">
      Inyección de las dependencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#informacion-importante" class="md-nav__link">
    <span class="md-ellipsis">
      Información importante
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Información importante">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#por-que-es-importante-esto" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Por qué es importante esto?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusión
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="inyeccion-de-dependencias">Inyección de dependencias<a class="headerlink" href="#inyeccion-de-dependencias" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>La inyección de dependencias es un patrón de diseño que permite a los objetos recibir sus dependencias de manera externa, en lugar de crearlas por sí mismos. Este enfoque facilita la gestión de componentes y promueve un código más modular y mantenible.</p>
<h2 id="para-que-sirve">Para qué sirve<a class="headerlink" href="#para-que-sirve" title="Permanent link">&para;</a></h2>
<ul>
<li>Simplifica las pruebas unitarias.</li>
<li>Facilita el mantenimiento y la escalabilidad.</li>
<li>Reduce el acoplamiento entre componentes.</li>
</ul>
<h2 id="importancia">Importancia<a class="headerlink" href="#importancia" title="Permanent link">&para;</a></h2>
<ul>
<li>Mejora la flexibilidad del código.</li>
<li>Permite una mayor reutilización de componentes.</li>
<li>Facilita la inyección de diferentes implementaciones o configuraciones en tiempo de ejecución.</li>
</ul>
<h2 id="tipos">Tipos<a class="headerlink" href="#tipos" title="Permanent link">&para;</a></h2>
<p>En el contexto de la inyección de dependencias, existen tres tipos principales de dependencias: <code>Singleton</code>, <code>Transient</code> y <code>Scoped</code>. Cada una se diferencia en cómo y cuándo se crean las instancias de los servicios a lo largo del ciclo de vida de la aplicación. Estas distintas formas de gestionar las dependencias permiten un mejor control sobre el uso de recursos, la eficiencia y la coherencia del estado en diferentes contextos de la aplicación.</p>
<h3 id="singleton">Singleton<a class="headerlink" href="#singleton" title="Permanent link">&para;</a></h3>
<p><strong>Descripción</strong>: Una única instancia de la dependencia es creada y compartida durante toda la vida de la aplicación.</p>
<p><strong>Casos de Uso</strong>: Utilizado para servicios de configuración, conexiones de base de datos o cualquier recurso compartido.</p>
<h3 id="scoped">Scoped<a class="headerlink" href="#scoped" title="Permanent link">&para;</a></h3>
<p><strong>Descripción</strong>: Una única instancia de la dependencia es creada y compartida durante el ciclo de vida de una solicitud (request).</p>
<p><strong>Casos de Uso</strong>: Adecuado para servicios que mantienen estado y necesitan ser consistentes durante una solicitud HTTP.</p>
<h3 id="transient">Transient<a class="headerlink" href="#transient" title="Permanent link">&para;</a></h3>
<p><strong>Descripción</strong>: Una nueva instancia de la dependencia es creada cada vez que se solicita.</p>
<p><strong>Casos de Uso</strong>: Ideal para servicios ligeros que no mantienen estado y son de corta duración.</p>
<pre class="mermaid"><code>sequenceDiagram
    participant Client
    participant Server
    participant Service
    participant Singleton_Instance
    participant Scoped_Instance
    participant Transient_Instance

    Client-&gt;&gt;Server: Solicitud
    Server-&gt;&gt;Service: Llamar servicio

    Service-&gt;&gt;Singleton_Instance: Verificar/Crear instancia
    Singleton_Instance--&gt;&gt;Service: Proveer instancia
    Note left of Singleton_Instance: La instancia no se volverá&lt;br&gt;a crear nunca más.

    Service-&gt;&gt;Scoped_Instance: Verificar / Crear instancia (Por solicitud)
    Scoped_Instance--&gt;&gt;Service: Proveer instancia
    Note left of Scoped_Instance: La instancia no se vuelve&lt;br&gt;a crear durante esta solicitud&lt;br&gt;pero creará una nueva en la&lt;br&gt;siguiente solicitud.

    Service-&gt;&gt;Transient_Instance: Crear nueva instancia (Cada vez)
    Transient_Instance--&gt;&gt;Service: Proveer instancia
    Note left of Transient_Instance: La instancia se volverá a&lt;br&gt;crear cada vez que se inyecte&lt;br&gt;en esta solicitud y en las&lt;br&gt;siguientes.

    Service--&gt;&gt;Server: Retornar instancia
    Server--&gt;&gt;Client: Respuesta</code></pre>
<h2 id="integracion">Integración<a class="headerlink" href="#integracion" title="Permanent link">&para;</a></h2>
<p>Existen tres métodos para almacenar las dependencias según sea el caso: <code>add_singleton</code>, <code>add_scoped</code>, <code>add_transient</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cafeto</span><span class="w"> </span><span class="kn">import</span> <span class="n">App</span>

<span class="n">app</span><span class="p">:</span> <span class="n">App</span> <span class="o">=</span> <span class="n">App</span><span class="p">()</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_singleton</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_transient</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>En el contexto de la inyección de dependencias, existen dos enfoques principales: basadas en <code>interfaces</code> o en <code>clases</code>. A continuación, se explica cada uno y se detalla cuándo es más apropiado utilizar uno u otro.</p>
<h2 id="inyeccion-de-dependencias-basada-en-interfaces">Inyección de Dependencias Basada en Interfaces<a class="headerlink" href="#inyeccion-de-dependencias-basada-en-interfaces" title="Permanent link">&para;</a></h2>
<p>Este enfoque implica definir una interfaz y asociarla con una clase concreta. Aunque Python no tiene interfaces como tal, es posible utilizar clases abstractas con el módulo <code>ABC</code> (Abstract Base Classes) para lograr una funcionalidad similar.</p>
<p><strong>Cuándo Usar</strong>:</p>
<ul>
<li><strong>Flexibilidad</strong>: Permite cambiar fácilmente la implementación de la interfaz sin modificar el código dependiente.</li>
<li><strong>Pruebas Unitarias</strong>: Facilita la creación de mock objects para pruebas.</li>
<li><strong>Desacoplamiento</strong>: Reduce la dependencia directa entre componentes, mejorando la mantenibilidad del código.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cafeto</span><span class="w"> </span><span class="kn">import</span> <span class="n">App</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AUserService</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">CreateUserRequestDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserResponseDto</span><span class="p">]:</span>
        <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">(</span><span class="n">AUserService</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">CreateUserRequestDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="o">&lt;</span><span class="n">some_database_connection</span><span class="o">&gt;.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span> <span class="c1">#(1)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserResponseDto</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="o">&lt;</span><span class="n">some_database_connection</span><span class="o">&gt;.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span> <span class="c1">#(2)</span>
            <span class="k">return</span> <span class="n">UserResponseDto</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<span class="n">app</span><span class="p">:</span> <span class="n">App</span> <span class="o">=</span> <span class="n">App</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">AUserService</span><span class="p">,</span> <span class="n">UserService</span><span class="p">)</span> <span class="c1"># Store service</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
   Servicio simulado para el ejemplo.</div>
</li>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Servicio simulado para el ejemplo.</p>
</div>
</li>
</ol>
<p>En el ejemplo anterior, se almacena la dependencia utilizando <code>AUserService</code> y <code>UserService</code>.</p>
<h3 id="por-que-es-esto-util">¿Por qué es esto útil?<a class="headerlink" href="#por-que-es-esto-util" title="Permanent link">&para;</a></h3>
<p>Supongamos que, más adelante en el proyecto, se requiere no almacenar los usuarios en una base de datos, sino enviarlos a un microservicio. En ese caso, podemos crear otra clase llamada <code>UserServiceToService</code> con los mismos métodos, sin necesidad de eliminar la clase actual <code>UserService</code>. Esto implica que no será necesario cambiar, en cada endpoint, la llamada al servicio. Además, nos permite conservar la clase original <code>UserService</code> en caso de llegar a ser requerida en el futuro.</p>
<p>Este enfoque permite:</p>
<ul>
<li><strong>Flexibilidad</strong>: Cambiar la implementación de los servicios sin afectar el código dependiente.</li>
<li><strong>Desacoplamiento</strong>: Mantener una separación clara entre la definición de la interfaz y su implementación, lo que mejora la mantenibilidad.</li>
<li><strong>Reutilización</strong>: Permitir que múltiples implementaciones coexistan y se utilicen en diferentes contextos según sea necesario.</li>
</ul>
<p>Ahora es importante saber cómo inyectar la dependencia, y para esto es indispensable <strong>no</strong> usar <code>UserService</code> directamente, sino <code>AUserService</code>, ya que es a través de esta interfaz como se llegará a <code>UserService</code>. Esto garantiza que el sistema pueda cambiar fácilmente la implementación de <code>AUserService</code> sin afectar el código dependiente, permitiendo una mayor flexibilidad y desacoplamiento en tu aplicación.</p>
<h2 id="inyeccion-de-dependencias-basada-en-clases">Inyección de Dependencias Basada en Clases<a class="headerlink" href="#inyeccion-de-dependencias-basada-en-clases" title="Permanent link">&para;</a></h2>
<p>Este enfoque implica inyectar directamente una clase concreta sin utilizar interfaces o clases abstractas. Es menos flexible pero puede ser adecuado para implementaciones simples y directas.</p>
<p><strong>Cuándo Usar</strong>:</p>
<ul>
<li><strong>Simplicidad</strong>: Adecuado para proyectos pequeños o cuando no se espera que la implementación cambie.</li>
<li><strong>Menos Sobrecarga</strong>: No necesitas definir clases abstractas o interfaces, lo que simplifica el desarrollo.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CacheUserService</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">CreateUserRequestDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="o">&lt;</span><span class="n">some_cache_connection</span><span class="o">&gt;.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span> <span class="c1">#(1)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserResponseDto</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="o">&lt;</span><span class="n">some_cache_connection</span><span class="o">&gt;.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span> <span class="c1">#(2)</span>
            <span class="k">return</span> <span class="n">UserResponseDto</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<span class="n">app</span><span class="p">:</span> <span class="n">App</span> <span class="o">=</span> <span class="n">App</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">CacheUserService</span><span class="p">)</span> <span class="c1"># Store service</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
   Servicio simulado para el ejemplo.</div>
</li>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Servicio simulado para el ejemplo.</p>
</div>
</li>
</ol>
<p>En este caso, a diferencia del ejemplo anterior, se utiliza únicamente <code>CacheUserService</code>. Esto se debe a que, durante la definición del proyecto, se estimó que las probabilidades de que este servicio cambie son casi nulas. Por lo tanto, este enfoque se consideró el más adecuado para este caso particular.</p>
<p>Para inyectar esta dependencia, es necesario usar <code>CacheUserService</code> directamente, ya que no se cuenta con una interfaz o clase abstracta asociada a esta implementación.</p>
<h2 id="comparacion-y-uso-en-python">Comparación y Uso en Python<a class="headerlink" href="#comparacion-y-uso-en-python" title="Permanent link">&para;</a></h2>
<p>En Python, dado que no existen interfaces formales como en otros lenguajes, es posible utilizar clases abstractas del módulo ABC para lograr una funcionalidad similar. Aquí tienes una comparación general:</p>
<p><strong>Inyección Basada en Interfaces (ABC)</strong>:</p>
<ul>
<li><strong>Pros</strong>: Flexibilidad, facilidad para pruebas unitarias, menor acoplamiento.</li>
<li><strong>Contras</strong>: Puede agregar complejidad adicional.</li>
</ul>
<p><strong>Inyección Basada en Clases</strong>:</p>
<ul>
<li><strong>Pros</strong>: Simplicidad, desarrollo más rápido.</li>
<li><strong>Contras</strong>: Menor flexibilidad, más difícil de cambiar o probar.</li>
</ul>
<h2 id="generador-generator">Generador (Generator)<a class="headerlink" href="#generador-generator" title="Permanent link">&para;</a></h2>
<p>El generador es otro parámetro (Opcional) al registrar una dependencia. Su función es brindar mayor control sobre cómo se crea y almacena dicha dependencia. Es un <code>Callable</code> que recibe como parámetro los datos necesarios para la dependencia registrada (<code>**data</code>).</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AMyService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_service</span><span class="p">:</span> <span class="n">AOtherService</span><span class="p">,</span> <span class="n">extra_param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_service</span><span class="p">:</span> <span class="n">AOtherService</span><span class="p">,</span> <span class="n">extra_param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other_service</span><span class="p">:</span> <span class="n">AOtherService</span> <span class="o">=</span> <span class="n">other_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extra_param</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">extra_param</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_service_generator</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
    <span class="n">params</span><span class="p">[</span><span class="s1">&#39;extra_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hello World!&#39;</span>
    <span class="k">return</span> <span class="n">MyService</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">AMyService</span><span class="p">,</span> <span class="n">MyService</span><span class="p">,</span> <span class="n">my_service_generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>La clase abstracta no es obligatoria, por lo que el código también podría simplificarse de esta forma:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MyService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_service</span><span class="p">:</span> <span class="n">AOtherService</span><span class="p">,</span> <span class="n">extra_param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other_service</span><span class="p">:</span> <span class="n">AOtherService</span> <span class="o">=</span> <span class="n">other_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extra_param</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">extra_param</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_service_generator</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
    <span class="n">params</span><span class="p">[</span><span class="s1">&#39;extra_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Hello World!&#39;</span>
    <span class="k">return</span> <span class="n">MyService</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">MyService</span><span class="p">,</span> <span class="n">my_service_generator</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Esto ofrece una mayor flexibilidad en la inyección de dependencias, ya que el generador permite no solo personalizar la creación de la dependencia, sino también realizar cualquier acción adicional según sea necesario.</p>
<p>Es importante tener en cuenta que el generador será invocado dependiendo del ciclo de vida de la dependencia (<code>Singleton</code>, <code>Scoped</code>, <code>Transient</code>):</p>
<ul>
<li><strong>Singleton</strong>: El generador se invocará solo una vez durante todo el proyecto.</li>
<li><strong>Scoped</strong>: Se ejecutará una vez por cada solicitud.</li>
<li><strong>Transient</strong>: Será invocado cada vez que se necesite inyectar la dependencia.</li>
</ul>
<h2 id="sobreescribir-override">Sobreescribir (override)<a class="headerlink" href="#sobreescribir-override" title="Permanent link">&para;</a></h2>
<p>Determinar si el registro de la dependencia es una sobreescritura requiere un parámetro adicional, el cual sirve para reemplazar una dependencia ya registrada. Este parámetro debe ser pasado como un argumento por palabra clave, es decir, debe referenciarse explícitamente usando el nombre del parámetro.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">MyService</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">AMyService</span><span class="p">,</span> <span class="n">MyService</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_scoped</span><span class="p">(</span><span class="n">AMyService</span><span class="p">,</span> <span class="n">MyService</span><span class="p">,</span> <span class="n">my_generator</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="remover-dependencias">Remover dependencias<a class="headerlink" href="#remover-dependencias" title="Permanent link">&para;</a></h2>
<p>Para remover una dependencia ya existente se puede usar el método <code>remove_&lt;type&gt;</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">app</span><span class="o">.</span><span class="n">remove_singleton</span><span class="p">(</span><span class="n">MyServiceSingleton</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">remove_scoped</span><span class="p">(</span><span class="n">AMyServiceScoped</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">remove_transient</span><span class="p">(</span><span class="n">AMyServiceTransient</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="inyeccion-de-las-dependencias">Inyección de las dependencias<a class="headerlink" href="#inyeccion-de-las-dependencias" title="Permanent link">&para;</a></h2>
<p>Las dependencias pueden ser inyectadas en varios lugares, desde el controlador, los métodos de validación de los DTO y otras dependencias. Para que esto sea posible es muy importante haberlas almacenado previamente con alguno de los métodos asociados a este <code>add_singleton</code>, <code>add_scoped</code> o <code>add_transient</code>.</p>
<p>En el caso de los controladores se inyectarán directamente en la acción.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">cafeto</span><span class="w"> </span><span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cafeto.mvc</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseController</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cafeto.responses</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ok</span><span class="p">,</span> <span class="n">NotFound</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">controller</span><span class="p">()</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserController</span><span class="p">(</span><span class="n">BaseController</span><span class="p">):</span>
    <span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/get/</span><span class="si">{id}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">service</span><span class="p">:</span> <span class="n">AUserService</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UserResponseDto</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="c1">#(1)</span>
        <span class="c1"># Your code here</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
   Servicio simulado para el ejemplo.</div>
</li>
</ol>
<p>En el caso de los validadores de los DTO se usan en cada uno de estos.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cafeto.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">validate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cafeto.errors</span><span class="w"> </span><span class="kn">import</span> <span class="n">FieldError</span><span class="p">,</span> <span class="n">Error</span><span class="p">,</span> <span class="n">ModelError</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CreateUserRequestDto</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@validate</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate_username</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">service</span><span class="p">:</span> <span class="n">AUserService</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">some_required_validation</span><span class="p">()</span> <span class="c1">#(1)</span>
        <span class="c1"># Your code here</span>

    <span class="nd">@validate</span><span class="p">()</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">service</span><span class="p">:</span> <span class="n">AUserService</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">some_required_validation</span><span class="p">()</span> <span class="c1">#(2)</span>
        <span class="c1"># Your code here</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
   Servicio simulado para el ejemplo.</div>
</li>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Servicio simulado para el ejemplo.</p>
</div>
</li>
</ol>
<p>En el caso de las otras dependencias estas se inyectan desde el constructor de la clase.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cafeto</span><span class="w"> </span><span class="kn">import</span> <span class="n">App</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AUserService</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some_service</span><span class="p">:</span> <span class="n">ASomeService</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">CreateUserRequestDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserResponseDto</span><span class="p">]:</span>
        <span class="o">...</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">(</span><span class="n">AUserService</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some_service</span><span class="p">:</span> <span class="n">ASomeService</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">some_service</span> <span class="o">=</span> <span class="n">some_service</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">CreateUserRequestDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">some_service</span><span class="o">.</span><span class="n">do_something_user</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="c1">#(1)</span>
        <span class="c1"># Your code here.</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UserResponseDto</span><span class="p">]:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">some_service</span><span class="o">.</span><span class="n">do_something_id</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="c1">#(2)</span>
        <span class="c1"># Your code here.</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
   Servicio simulado para el ejemplo.</div>
</li>
<li>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Servicio simulado para el ejemplo.</p>
</div>
</li>
</ol>
<p>Es importante aclarar que, una vez se inicia con la primera dependencia, esta creará un sistema recursivo donde se analizará cada dependencia para poder inyectar de forma correcta cada una de ellas donde se necesite.</p>
<h2 id="informacion-importante">Información importante<a class="headerlink" href="#informacion-importante" title="Permanent link">&para;</a></h2>
<p>Las dependencias de tipo <code>Singleton</code>, al ser permanentes, se comparten entre los diferentes usuarios que ingresan al sistema en cada solicitud. Esto significa que la información almacenada en estas debe ser, preferiblemente, información que no esté relacionada con la sesión del usuario y que sea inmutable.</p>
<h3 id="por-que-es-importante-esto">¿Por qué es importante esto?<a class="headerlink" href="#por-que-es-importante-esto" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Si se almacena información relacionada con la sesión del usuario, esta podría solaparse entre solicitudes diferentes, generando un agujero de seguridad que podría permitir el acceso no autorizado a determinados servicios.</p>
</li>
<li>
<p>Si la información es mutable (independientemente del tipo), podría sobrescribirse de manera insegura entre solicitudes concurrentes. Esto es lo que se conoce como <code>Condiciones de carrera (Race Conditions)</code>. Aunque existe una forma de prevenirlo mediante el uso de bloqueos temporales del recurso, no se recomienda hacerlo para evitar generar cuellos de botella, ya que el bloqueo puede afectar el rendimiento general del sistema.</p>
</li>
</ol>
<h3 id="ejemplo">Ejemplo<a class="headerlink" href="#ejemplo" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyServiceSingleton</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>  <span class="c1"># Block the resource</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="c1"># Block the resource</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<p>Como se muestra en el ejemplo, esto puede causar tiempos de espera no deseados. Por esta razón, se recomienda optar por una arquitectura sin bloqueos (<code>No Lock Contention</code>) para mejorar la eficiencia del sistema.</p>
<h2 id="conclusion">Conclusión<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Es crucial entender los tres tipos de inyección de dependencias (<code>Singleton</code>, <code>Transient</code> y <code>Scoped</code>) y los dos métodos para implementar la inyección de dependencias, ya sea a través de <code>interfaces</code> o <code>clases</code>. Esta comprensión te permitirá diseñar sistemas más flexibles, mantenibles y escalables, adaptándose a las necesidades específicas de cada proyecto.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": {"alias": true, "default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>