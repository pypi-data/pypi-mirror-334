"use strict";(self.webpackChunkfirebird=self.webpackChunkfirebird||[]).push([[2855],{2855:(S,m,p)=>{p.r(m),p.d(m,{TWebPaintingPainter:()=>y});var A=p(467),B=p(6823),M=p(675);class y extends M.JW{updateObject(e){return!!this.matchObjectType(e)&&(this.assignObject(e),!0)}redraw(){var e=this;return(0,A.A)(function*(){const r=e.getObject(),n=e.getAxisToSvgFunc();if(!r?.fOper||!n)return;let d,T,a,s=0,f={},x=null,P="none",g="";const o=r.fOper.split(";"),u=t=>{if(t===P||(x&&(x.attr("d",g),g="",x=null,P="none"),!t))return e;switch(P=t,x=e.draw_g.append("svg:path").attr("d",""),t){case"f":x.call(e.fillatt.func);break;case"l":x.call(e.lineatt.func).style("fill","none");break;case"m":x.call(e.markeratt.func)}return e},b=(t,h)=>{let i=0;const l={_typename:"any"};for(let c=0;c<h.length;++c){const _=t.indexOf(":",i+1);l[h[c]]=parseInt(t.slice(i+1,_>i?_:void 0)),i=_}return l},O=t=>{for(;++t<o.length;)switch(d=o[t][0],d){case"z":e.createAttLine({attr:b(o[t],["fLineColor","fLineStyle","fLineWidth"]),force:!0}),u();continue;case"y":e.createAttFill({attr:b(o[t],["fFillColor","fFillStyle"]),force:!0}),u();continue;case"x":e.createAttMarker({attr:b(o[t],["fMarkerColor","fMarkerStyle","fMarkerSize"]),force:!0}),u();continue;case"o":f=b(o[t],["fTextColor","fTextFont","fTextSize","fTextAlign","fTextAngle"]),f.fTextSize<0&&(f.fTextSize*=-.001),u();continue;case"r":case"b":{u("b"===d?"f":"l");const h=n.x(r.fBuf[s++]),i=n.y(r.fBuf[s++]),l=n.x(r.fBuf[s++]),c=n.y(r.fBuf[s++]);g+=`M${h},${i}h${l-h}v${c-i}h${h-l}z`;continue}case"l":case"f":for(u(d),T=parseInt(o[t].slice(1)),a=0;a<T;++a)g+=`${a>0?"L":"M"}${n.x(r.fBuf[s++])},${n.y(r.fBuf[s++])}`;"f"===d&&(g+="Z");continue;case"m":for(u(d),T=parseInt(o[t].slice(1)),e.markeratt.resetPos(),a=0;a<T;++a)g+=e.markeratt.create(n.x(r.fBuf[s++]),n.y(r.fBuf[s++]));continue;case"h":case"t":if(f.fTextSize){u();const h=f.fTextSize>1?f.fTextSize:e.getPadPainter().getPadHeight()*f.fTextSize,i=e.draw_g.append("svg:g");return e.startTextDrawingAsync(f.fTextFont,h,i).then(()=>{let l=o[t].slice(1),c=f.fTextAngle;if(c>=360&&(c-=360*Math.floor(c/360)),"h"===d){let _="";for(a=0;a<l.length;a+=2)_+=String.fromCharCode(parseInt(l.slice(a,a+2),16));l=_}return e.drawText({align:f.fTextAlign,x:n.x(r.fBuf[s++]),y:n.y(r.fBuf[s++]),rotate:-c,text:l,color:(0,B.oU)(f.fTextColor),latex:0,draw_g:i}),e.finishTextDrawing(i)}).then(()=>O(t))}continue;default:console.log(`unsupported operation ${d}`)}return Promise.resolve(!0)};return e.createG(),O(-1).then(()=>u())})()}static draw(e,r){return(0,A.A)(function*(){const n=new y(e,r);return n.addToPadPrimitives(),n.redraw()})()}}}}]);