# ruff: noqa: F401

import os

import numpy as np

from metasim.cfg.checkers import PositionShiftCheckerWithTolerance, UpAxisRotationChecker
from metasim.cfg.objects import RigidObjMetaCfg
from metasim.cfg.robots import FrankaMetaCfg
from metasim.cfg.scenes import SceneMetaCfg
from metasim.cfg.tasks import BaseTaskMetaCfg
from metasim.constants import PhysicStateType
from metasim.utils import configclass

from .arnold_task_metacfg import ArnoldTaskMetaCfg

# Global table to store unique scale tuples.
SCALE_TABLE = []


def get_scale_friendly_name(scale_values):
    """
    Given a list of scale values, return a friendly name based on an index in the SCALE_TABLE.
    If the scale tuple is not in the table, add it.
    """
    scale_tuple = tuple(scale_values)
    if scale_tuple not in SCALE_TABLE:
        SCALE_TABLE.append(scale_tuple)
    index = SCALE_TABLE.index(scale_tuple)
    return f"{index}"


# Example list of JSON filenames.
json_filenames = [
    "3854_[10.0912, 12.0, 10.0912]_0_v2.pkl.gz",
    "3854_[10.0912, 12.0, 10.0912]_135_v2.pkl.gz",
    "3854_[10.0912, 12.0, 10.0912]_180_v2.pkl.gz",
    "3854_[10.0912, 12.0, 10.0912]_45_v2.pkl.gz",
    "3854_[10.1448, 12.0, 10.1448]_0_v2.pkl.gz",
    "3854_[10.1448, 12.0, 10.1448]_135_v2.pkl.gz",
    "3854_[10.1448, 12.0, 10.1448]_180_v2.pkl.gz",
    "3854_[10.1448, 12.0, 10.1448]_45_v2.pkl.gz",
    "3854_[10.3848, 12.0, 10.3848]_0_v2.pkl.gz",
    "3854_[10.3848, 12.0, 10.3848]_135_v2.pkl.gz",
    "3854_[10.3848, 12.0, 10.3848]_180_v2.pkl.gz",
    "3854_[10.3848, 12.0, 10.3848]_45_v2.pkl.gz",
    "3854_[12.0, 12.0, 12.0]_0_v2.pkl.gz",
    "3854_[12.0, 12.0, 12.0]_135_v2.pkl.gz",
    "3854_[12.0, 12.0, 12.0]_180_v2.pkl.gz",
    "3854_[12.0, 12.0, 12.0]_45_v2.pkl.gz",
    "3854_[9.2504, 12.0, 9.2504]_0_v2.pkl.gz",
    "3854_[9.2504, 12.0, 9.2504]_135_v2.pkl.gz",
    "3854_[9.2504, 12.0, 9.2504]_180_v2.pkl.gz",
    "3854_[9.2504, 12.0, 9.2504]_45_v2.pkl.gz",
    "3854_[9.4296, 12.0, 9.4296]_0_v2.pkl.gz",
    "3854_[9.4296, 12.0, 9.4296]_135_v2.pkl.gz",
    "3854_[9.4296, 12.0, 9.4296]_180_v2.pkl.gz",
    "3854_[9.4296, 12.0, 9.4296]_45_v2.pkl.gz",
    "3854_[9.6224, 12.0, 9.6224]_0_v2.pkl.gz",
    "3854_[9.6224, 12.0, 9.6224]_135_v2.pkl.gz",
    "3854_[9.6224, 12.0, 9.6224]_180_v2.pkl.gz",
    "3854_[9.6224, 12.0, 9.6224]_45_v2.pkl.gz",
    "3854_[9.840000000000002, 9.840000000000002, 9.840000000000002]_0_v2.pkl.gz",
    "3854_[9.840000000000002, 9.840000000000002, 9.840000000000002]_135_v2.pkl.gz",
    "3854_[9.840000000000002, 9.840000000000002, 9.840000000000002]_180_v2.pkl.gz",
    "3854_[9.840000000000002, 9.840000000000002, 9.840000000000002]_45_v2.pkl.gz",
    "3854_[9.971200000000001, 12.0, 9.971200000000001]_0_v2.pkl.gz",
    "3854_[9.971200000000001, 12.0, 9.971200000000001]_135_v2.pkl.gz",
    "3854_[9.971200000000001, 12.0, 9.971200000000001]_180_v2.pkl.gz",
    "3854_[9.971200000000001, 12.0, 9.971200000000001]_45_v2.pkl.gz",
    "3933_[7.5848, 9.291200000000002, 7.5848]_0_v2.pkl.gz",
    "3933_[7.5848, 9.291200000000002, 7.5848]_135_v2.pkl.gz",
    "3933_[7.5848, 9.291200000000002, 7.5848]_180_v2.pkl.gz",
    "3933_[7.5848, 9.291200000000002, 7.5848]_45_v2.pkl.gz",
    "3933_[7.944, 12.0, 7.944]_0_v2.pkl.gz",
    "3933_[7.944, 12.0, 7.944]_135_v2.pkl.gz",
    "3933_[7.944, 12.0, 7.944]_180_v2.pkl.gz",
    "3933_[7.944, 12.0, 7.944]_45_v2.pkl.gz",
    "3933_[8.316, 12.0, 8.316]_0_v2.pkl.gz",
    "3933_[8.316, 12.0, 8.316]_135_v2.pkl.gz",
    "3933_[8.316, 12.0, 8.316]_180_v2.pkl.gz",
    "3933_[8.316, 12.0, 8.316]_45_v2.pkl.gz",
    "3933_[9.136000000000001, 12.0, 9.136000000000001]_0_v2.pkl.gz",
    "3933_[9.136000000000001, 12.0, 9.136000000000001]_135_v2.pkl.gz",
    "3933_[9.136000000000001, 12.0, 9.136000000000001]_180_v2.pkl.gz",
    "3933_[9.136000000000001, 12.0, 9.136000000000001]_45_v2.pkl.gz",
    "3934_[4.4712000000000005, 12.0, 4.4712000000000005]_0_v2.pkl.gz",
    "3934_[4.4712000000000005, 12.0, 4.4712000000000005]_180_v2.pkl.gz",
    "3934_[4.4712000000000005, 12.0, 4.4712000000000005]_45_v2.pkl.gz",
    "3934_[4.7863999999999995, 7.476800000000001, 4.7863999999999995]_0_v2.pkl.gz",
    "3934_[4.7863999999999995, 7.476800000000001, 4.7863999999999995]_135_v2.pkl.gz",
    "3934_[4.7863999999999995, 7.476800000000001, 4.7863999999999995]_180_v2.pkl.gz",
    "3934_[4.7863999999999995, 7.476800000000001, 4.7863999999999995]_45_v2.pkl.gz",
    "3934_[4.920000000000001, 4.920000000000001, 4.920000000000001]_0_v2.pkl.gz",
    "3934_[4.920000000000001, 4.920000000000001, 4.920000000000001]_135_v2.pkl.gz",
    "3934_[4.920000000000001, 4.920000000000001, 4.920000000000001]_180_v2.pkl.gz",
    "3934_[4.920000000000001, 4.920000000000001, 4.920000000000001]_45_v2.pkl.gz",
    "3934_[5.2488, 7.32, 5.2488]_0_v2.pkl.gz",
    "3934_[5.2488, 7.32, 5.2488]_180_v2.pkl.gz",
    "3934_[5.2488, 7.32, 5.2488]_45_v2.pkl.gz",
    "3934_[5.420000000000001, 8.28, 5.420000000000001]_0_v2.pkl.gz",
    "3934_[5.420000000000001, 8.28, 5.420000000000001]_135_v2.pkl.gz",
    "3934_[5.420000000000001, 8.28, 5.420000000000001]_180_v2.pkl.gz",
    "3934_[5.420000000000001, 8.28, 5.420000000000001]_45_v2.pkl.gz",
    "3934_[5.5704, 8.6552, 5.5704]_0_v2.pkl.gz",
    "3934_[5.5704, 8.6552, 5.5704]_135_v2.pkl.gz",
    "3934_[5.5704, 8.6552, 5.5704]_180_v2.pkl.gz",
    "3934_[5.5704, 8.6552, 5.5704]_45_v2.pkl.gz",
    "3934_[5.5776, 6.96, 5.5776]_0_v2.pkl.gz",
    "3934_[5.5776, 6.96, 5.5776]_135_v2.pkl.gz",
    "3934_[5.5776, 6.96, 5.5776]_180_v2.pkl.gz",
    "3934_[5.5776, 6.96, 5.5776]_45_v2.pkl.gz",
    "3990_[6.1224, 12.0, 9.550400000000002]_0_v2.pkl.gz",
    "3990_[6.1224, 12.0, 9.550400000000002]_135_v2.pkl.gz",
    "3990_[6.1224, 12.0, 9.550400000000002]_180_v2.pkl.gz",
    "3990_[6.1224, 12.0, 9.550400000000002]_45_v2.pkl.gz",
    "3990_[6.4264, 8.745600000000001, 10.1744]_0_v2.pkl.gz",
    "3990_[6.4264, 8.745600000000001, 10.1744]_135_v2.pkl.gz",
    "3990_[6.4264, 8.745600000000001, 10.1744]_180_v2.pkl.gz",
    "3990_[6.4264, 8.745600000000001, 10.1744]_45_v2.pkl.gz",
    "3990_[7.7592, 9.044, 9.6232]_0_v2.pkl.gz",
    "3990_[7.7592, 9.044, 9.6232]_135_v2.pkl.gz",
    "3990_[7.7592, 9.044, 9.6232]_180_v2.pkl.gz",
    "3990_[7.7592, 9.044, 9.6232]_45_v2.pkl.gz",
    "3990_[7.8472, 12.0, 12.0]_0_v2.pkl.gz",
    "3990_[7.8472, 12.0, 12.0]_135_v2.pkl.gz",
    "3990_[7.8472, 12.0, 12.0]_180_v2.pkl.gz",
    "3990_[7.8472, 12.0, 12.0]_45_v2.pkl.gz",
    "3990_[7.9544, 12.0, 12.0]_0_v2.pkl.gz",
    "3990_[7.9544, 12.0, 12.0]_135_v2.pkl.gz",
    "3990_[7.9544, 12.0, 12.0]_180_v2.pkl.gz",
    "3990_[7.9544, 12.0, 12.0]_45_v2.pkl.gz",
    "3990_[8.1832, 12.0, 9.2256]_0_v2.pkl.gz",
    "3990_[8.1832, 12.0, 9.2256]_135_v2.pkl.gz",
    "3990_[8.1832, 12.0, 9.2256]_180_v2.pkl.gz",
    "3990_[8.1832, 12.0, 9.2256]_45_v2.pkl.gz",
    "4084_[3.8280000000000003, 8.512, 3.8280000000000003]_0_v2.pkl.gz",
    "4084_[3.8280000000000003, 8.512, 3.8280000000000003]_180_v2.pkl.gz",
    "4084_[3.8280000000000003, 8.512, 3.8280000000000003]_45_v2.pkl.gz",
    "4084_[4.6664, 9.96, 4.6664]_0_v2.pkl.gz",
    "4084_[4.6664, 9.96, 4.6664]_135_v2.pkl.gz",
    "4084_[4.6664, 9.96, 4.6664]_180_v2.pkl.gz",
    "4084_[4.6664, 9.96, 4.6664]_45_v2.pkl.gz",
    "4084_[4.7896, 12.0, 4.7896]_0_v2.pkl.gz",
    "4084_[4.7896, 12.0, 4.7896]_135_v2.pkl.gz",
    "4084_[4.7896, 12.0, 4.7896]_180_v2.pkl.gz",
    "4084_[4.7896, 12.0, 4.7896]_45_v2.pkl.gz",
    "4084_[5.2304, 12.0, 5.2304]_0_v2.pkl.gz",
    "4084_[5.2304, 12.0, 5.2304]_135_v2.pkl.gz",
    "4084_[5.2304, 12.0, 5.2304]_180_v2.pkl.gz",
    "4084_[5.2304, 12.0, 5.2304]_45_v2.pkl.gz",
    "4084_[5.2304, 8.9048, 5.2304]_0_v2.pkl.gz",
    "4084_[5.2304, 8.9048, 5.2304]_135_v2.pkl.gz",
    "4084_[5.2304, 8.9048, 5.2304]_180_v2.pkl.gz",
    "4084_[5.2304, 8.9048, 5.2304]_45_v2.pkl.gz",
    "4118_[3.2736, 7.440000000000001, 3.2736]_0_v2.pkl.gz",
    "4118_[3.2736, 7.440000000000001, 3.2736]_180_v2.pkl.gz",
    "4118_[3.2736, 7.440000000000001, 3.2736]_45_v2.pkl.gz",
    "4118_[3.6264000000000003, 7.8264, 3.6264000000000003]_0_v2.pkl.gz",
    "4118_[3.6264000000000003, 7.8264, 3.6264000000000003]_180_v2.pkl.gz",
    "4118_[3.6264000000000003, 7.8264, 3.6264000000000003]_45_v2.pkl.gz",
    "4118_[4.1095999999999995, 12.0, 4.1095999999999995]_0_v2.pkl.gz",
    "4118_[4.1095999999999995, 12.0, 4.1095999999999995]_135_v2.pkl.gz",
    "4118_[4.1095999999999995, 12.0, 4.1095999999999995]_180_v2.pkl.gz",
    "4118_[4.1095999999999995, 12.0, 4.1095999999999995]_45_v2.pkl.gz",
    "4118_[4.252000000000001, 6.9, 4.252000000000001]_0_v2.pkl.gz",
    "4118_[4.252000000000001, 6.9, 4.252000000000001]_135_v2.pkl.gz",
    "4118_[4.252000000000001, 6.9, 4.252000000000001]_180_v2.pkl.gz",
    "4118_[4.252000000000001, 6.9, 4.252000000000001]_45_v2.pkl.gz",
    "4118_[4.4416, 12.0, 4.4416]_0_v2.pkl.gz",
    "4118_[4.4416, 12.0, 4.4416]_135_v2.pkl.gz",
    "4118_[4.4416, 12.0, 4.4416]_180_v2.pkl.gz",
    "4118_[4.4416, 12.0, 4.4416]_45_v2.pkl.gz",
    "4118_[4.4888, 12.0, 4.4888]_0_v2.pkl.gz",
    "4118_[4.4888, 12.0, 4.4888]_135_v2.pkl.gz",
    "4118_[4.4888, 12.0, 4.4888]_180_v2.pkl.gz",
    "4118_[4.4888, 12.0, 4.4888]_45_v2.pkl.gz",
    "4118_[4.7392, 10.672, 4.7392]_0_v2.pkl.gz",
    "4118_[4.7392, 10.672, 4.7392]_135_v2.pkl.gz",
    "4118_[4.7392, 10.672, 4.7392]_180_v2.pkl.gz",
    "4118_[4.7392, 10.672, 4.7392]_45_v2.pkl.gz",
    "4118_[4.985600000000001, 8.7024, 4.985600000000001]_0_v2.pkl.gz",
    "4118_[4.985600000000001, 8.7024, 4.985600000000001]_135_v2.pkl.gz",
    "4118_[4.985600000000001, 8.7024, 4.985600000000001]_180_v2.pkl.gz",
    "4118_[4.985600000000001, 8.7024, 4.985600000000001]_45_v2.pkl.gz",
    "4200_[4.558400000000001, 10.388, 4.558400000000001]_0_v2.pkl.gz",
    "4200_[4.558400000000001, 10.388, 4.558400000000001]_135_v2.pkl.gz",
    "4200_[4.558400000000001, 10.388, 4.558400000000001]_180_v2.pkl.gz",
    "4200_[4.558400000000001, 10.388, 4.558400000000001]_45_v2.pkl.gz",
    "4200_[4.5712, 12.0, 4.5712]_0_v2.pkl.gz",
    "4200_[4.5712, 12.0, 4.5712]_135_v2.pkl.gz",
    "4200_[4.5712, 12.0, 4.5712]_180_v2.pkl.gz",
    "4200_[4.5712, 12.0, 4.5712]_45_v2.pkl.gz",
    "4200_[4.847200000000001, 10.268, 4.847200000000001]_0_v2.pkl.gz",
    "4200_[4.847200000000001, 10.268, 4.847200000000001]_135_v2.pkl.gz",
    "4200_[4.847200000000001, 10.268, 4.847200000000001]_180_v2.pkl.gz",
    "4200_[4.847200000000001, 10.268, 4.847200000000001]_45_v2.pkl.gz",
    "4200_[4.944800000000001, 6.3872, 4.944800000000001]_0_v2.pkl.gz",
    "4200_[4.944800000000001, 6.3872, 4.944800000000001]_180_v2.pkl.gz",
    "4200_[4.944800000000001, 6.3872, 4.944800000000001]_45_v2.pkl.gz",
    "4200_[5.3856, 10.836, 5.3856]_0_v2.pkl.gz",
    "4200_[5.3856, 10.836, 5.3856]_180_v2.pkl.gz",
    "4200_[5.3856, 10.836, 5.3856]_45_v2.pkl.gz",
    "4233_[2.7688, 6.720000000000001, 2.7688]_0_v2.pkl.gz",
    "4233_[2.7688, 6.720000000000001, 2.7688]_135_v2.pkl.gz",
    "4233_[2.7688, 6.720000000000001, 2.7688]_180_v2.pkl.gz",
    "4233_[2.7688, 6.720000000000001, 2.7688]_45_v2.pkl.gz",
    "4233_[3.2152000000000003, 10.601600000000001, 3.2152000000000003]_0_v2.pkl.gz",
    "4233_[3.2152000000000003, 10.601600000000001, 3.2152000000000003]_180_v2.pkl.gz",
    "4233_[3.2152000000000003, 10.601600000000001, 3.2152000000000003]_45_v2.pkl.gz",
    "4233_[3.3752000000000004, 6.4984, 3.3752000000000004]_0_v2.pkl.gz",
    "4233_[3.3752000000000004, 6.4984, 3.3752000000000004]_135_v2.pkl.gz",
    "4233_[3.3752000000000004, 6.4984, 3.3752000000000004]_180_v2.pkl.gz",
    "4233_[3.3752000000000004, 6.4984, 3.3752000000000004]_45_v2.pkl.gz",
    "4233_[3.5936000000000003, 7.980800000000001, 3.5936000000000003]_0_v2.pkl.gz",
    "4233_[3.5936000000000003, 7.980800000000001, 3.5936000000000003]_135_v2.pkl.gz",
    "4233_[3.5936000000000003, 7.980800000000001, 3.5936000000000003]_180_v2.pkl.gz",
    "4233_[3.5936000000000003, 7.980800000000001, 3.5936000000000003]_45_v2.pkl.gz",
    "4233_[4.1024, 9.8992, 4.1024]_0_v2.pkl.gz",
    "4233_[4.1024, 9.8992, 4.1024]_135_v2.pkl.gz",
    "4233_[4.1024, 9.8992, 4.1024]_180_v2.pkl.gz",
    "4233_[4.1024, 9.8992, 4.1024]_45_v2.pkl.gz",
    "4233_[4.104, 6.401600000000001, 4.104]_0_v2.pkl.gz",
    "4233_[4.104, 6.401600000000001, 4.104]_135_v2.pkl.gz",
    "4233_[4.104, 6.401600000000001, 4.104]_180_v2.pkl.gz",
    "4233_[4.104, 6.401600000000001, 4.104]_45_v2.pkl.gz",
    "4233_[4.3912, 6.6575999999999995, 4.3912]_0_v2.pkl.gz",
    "4233_[4.3912, 6.6575999999999995, 4.3912]_135_v2.pkl.gz",
    "4233_[4.3912, 6.6575999999999995, 4.3912]_180_v2.pkl.gz",
    "4233_[4.3912, 6.6575999999999995, 4.3912]_45_v2.pkl.gz",
    "4314_[4.5888, 12.0, 4.5888]_0_v2.pkl.gz",
    "4314_[4.5888, 12.0, 4.5888]_180_v2.pkl.gz",
    "4314_[4.5888, 12.0, 4.5888]_45_v2.pkl.gz",
    "4314_[5.1968000000000005, 8.9304, 5.1968000000000005]_0_v2.pkl.gz",
    "4314_[5.1968000000000005, 8.9304, 5.1968000000000005]_180_v2.pkl.gz",
    "4314_[5.1968000000000005, 8.9304, 5.1968000000000005]_45_v2.pkl.gz",
    "4314_[5.7392, 9.7064, 5.7392]_0_v2.pkl.gz",
    "4314_[5.7392, 9.7064, 5.7392]_180_v2.pkl.gz",
    "4314_[5.7392, 9.7064, 5.7392]_45_v2.pkl.gz",
    "4314_[6.1240000000000006, 9.8008, 6.1240000000000006]_0_v2.pkl.gz",
    "4314_[6.1240000000000006, 9.8008, 6.1240000000000006]_180_v2.pkl.gz",
    "4314_[6.1240000000000006, 9.8008, 6.1240000000000006]_45_v2.pkl.gz",
    "4314_[6.1272, 7.56, 6.1272]_0_v2.pkl.gz",
    "4314_[6.1272, 7.56, 6.1272]_180_v2.pkl.gz",
    "4314_[6.1272, 7.56, 6.1272]_45_v2.pkl.gz",
    "4393_[5.000800000000001, 8.0, 5.000800000000001]_0_v2.pkl.gz",
    "4393_[5.000800000000001, 8.0, 5.000800000000001]_180_v2.pkl.gz",
    "4393_[5.000800000000001, 8.0, 5.000800000000001]_45_v2.pkl.gz",
    "4393_[5.3736, 9.0488, 5.3736]_0_v2.pkl.gz",
    "4393_[5.3736, 9.0488, 5.3736]_180_v2.pkl.gz",
    "4393_[5.3736, 9.0488, 5.3736]_45_v2.pkl.gz",
    "4393_[5.5760000000000005, 8.0, 5.5760000000000005]_0_v2.pkl.gz",
    "4393_[5.5760000000000005, 8.0, 5.5760000000000005]_180_v2.pkl.gz",
    "4393_[5.5760000000000005, 8.0, 5.5760000000000005]_45_v2.pkl.gz",
    "4393_[6.4744, 8.0, 6.4744]_0_v2.pkl.gz",
    "4393_[6.4744, 8.0, 6.4744]_180_v2.pkl.gz",
    "4393_[6.4744, 8.0, 6.4744]_45_v2.pkl.gz",
    # ... include the rest of your filenames here
]

# Generate a dictionary of config classes keyed by their class name.
for filename in json_filenames:
    object_id = filename.split("_")[0]
    scale = filename.split("_")[1].strip("[]")
    scale = [float(val) for val in scale.split(",")]
    target = filename.split("_")[2]
    code = f"""@configclass
class ArnoldReorientObject{object_id}{get_scale_friendly_name(scale)}{target}MetaCfg(ArnoldTaskMetaCfg):
    episode_length = 1600
    try_add_table = False
    decimation = 1

    traj_filepath = "roboverse_data/assets/arnold/reorient_object_merged_pickle/{filename}"
    object_usd_path = "roboverse_data/assets/arnold/sample/custom/Bottle/{object_id}/mobility.usd"
    scale = {scale}
    target = {target}

    def __post_init__(self):
        scale = [s * 0.01 for s in self.scale]

        # cm to m
        target = float(self.target) * 0.01

        self.objects = [
            RigidObjMetaCfg(
                name="Bottle",
                usd_path=self.object_usd_path,
                physics=PhysicStateType.RIGIDBODY,
                scale=scale,
            ),
        ]

        self.checker = UpAxisRotationChecker(
            obj_name="Bottle",
            axis="z",
            degree_threshold=21,
            target_degree={target},
        )

        self.robot = FrankaMetaCfg(
            name="franka",
        )
"""
    exec(code)


# Now, if you list __all__, you can include all the generated names so that
# "from .arnold.arnold_pickup_object import *" only imports these.
__all__ = [name for name in globals() if name.startswith("ArnoldReorientObject")]
