# ruff: noqa: F401

import os

import numpy as np

from metasim.cfg.checkers import PositionShiftCheckerWithTolerance
from metasim.cfg.objects import RigidObjMetaCfg
from metasim.cfg.robots import FrankaMetaCfg
from metasim.cfg.scenes import SceneMetaCfg
from metasim.cfg.tasks import BaseTaskMetaCfg
from metasim.constants import PhysicStateType
from metasim.utils import configclass

from .arnold_task_metacfg import ArnoldTaskMetaCfg

# Global table to store unique scale tuples.
SCALE_TABLE = []


def get_scale_friendly_name(scale_values):
    """Given a list of scale values, return a friendly name based on an index in the SCALE_TABLE.
    If the scale tuple is not in the table, add it.
    """
    scale_tuple = tuple(scale_values)
    if scale_tuple not in SCALE_TABLE:
        SCALE_TABLE.append(scale_tuple)
    index = SCALE_TABLE.index(scale_tuple)
    return f"{index}"


# Example list of JSON filenames.
json_filenames = [
    "3380_[12.0, 12.0, 12.0]_10_v2.pkl.gz",
    "3380_[12.0, 12.0, 12.0]_20_v2.pkl.gz",
    "3380_[12.0, 12.0, 12.0]_30_v2.pkl.gz",
    "3380_[12.0, 12.0, 12.0]_40_v2.pkl.gz",
    "3398_[6.332000000000001, 12.0, 6.332000000000001]_10_v2.pkl.gz",
    "3398_[6.332000000000001, 12.0, 6.332000000000001]_20_v2.pkl.gz",
    "3398_[6.332000000000001, 12.0, 6.332000000000001]_30_v2.pkl.gz",
    "3398_[6.332000000000001, 12.0, 6.332000000000001]_40_v2.pkl.gz",
    "3398_[6.9672, 12.0, 6.9672]_10_v2.pkl.gz",
    "3398_[6.9672, 12.0, 6.9672]_20_v2.pkl.gz",
    "3398_[6.9672, 12.0, 6.9672]_30_v2.pkl.gz",
    "3398_[6.9672, 12.0, 6.9672]_40_v2.pkl.gz",
    "3398_[7.1128, 12.0, 7.1128]_10_v2.pkl.gz",
    "3398_[7.1128, 12.0, 7.1128]_20_v2.pkl.gz",
    "3398_[7.1128, 12.0, 7.1128]_30_v2.pkl.gz",
    "3398_[7.1128, 12.0, 7.1128]_40_v2.pkl.gz",
    "3398_[7.548000000000001, 7.548000000000001, 7.548000000000001]_10_v2.pkl.gz",
    "3398_[7.548000000000001, 7.548000000000001, 7.548000000000001]_20_v2.pkl.gz",
    "3398_[7.548000000000001, 7.548000000000001, 7.548000000000001]_30_v2.pkl.gz",
    "3398_[7.7592, 12.0, 7.7592]_10_v2.pkl.gz",
    "3398_[7.7592, 12.0, 7.7592]_20_v2.pkl.gz",
    "3398_[7.7592, 12.0, 7.7592]_30_v2.pkl.gz",
    "3398_[7.7592, 12.0, 7.7592]_40_v2.pkl.gz",
    "3398_[8.716800000000001, 12.0, 8.716800000000001]_10_v2.pkl.gz",
    "3398_[8.716800000000001, 12.0, 8.716800000000001]_20_v2.pkl.gz",
    "3398_[8.716800000000001, 12.0, 8.716800000000001]_30_v2.pkl.gz",
    "3398_[8.716800000000001, 12.0, 8.716800000000001]_40_v2.pkl.gz",
    "3517_[6.1248000000000005, 12.0, 6.7312]_10_v2.pkl.gz",
    "3517_[6.1248000000000005, 12.0, 6.7312]_20_v2.pkl.gz",
    "3517_[6.1248000000000005, 12.0, 6.7312]_30_v2.pkl.gz",
    "3517_[6.1248000000000005, 12.0, 6.7312]_40_v2.pkl.gz",
    "3517_[6.9448, 12.0, 6.9448]_10_v2.pkl.gz",
    "3517_[6.9448, 12.0, 6.9448]_20_v2.pkl.gz",
    "3517_[6.9448, 12.0, 6.9448]_30_v2.pkl.gz",
    "3517_[6.9448, 12.0, 6.9448]_40_v2.pkl.gz",
    "3517_[7.765600000000001, 12.0, 7.765600000000001]_10_v2.pkl.gz",
    "3517_[7.765600000000001, 12.0, 7.765600000000001]_20_v2.pkl.gz",
    "3517_[7.765600000000001, 12.0, 7.765600000000001]_30_v2.pkl.gz",
    "3517_[7.765600000000001, 12.0, 7.765600000000001]_40_v2.pkl.gz",
    "3517_[7.860800000000001, 12.0, 7.860800000000001]_10_v2.pkl.gz",
    "3517_[7.860800000000001, 12.0, 7.860800000000001]_20_v2.pkl.gz",
    "3517_[7.860800000000001, 12.0, 7.860800000000001]_30_v2.pkl.gz",
    "3517_[7.860800000000001, 12.0, 7.860800000000001]_40_v2.pkl.gz",
    "3517_[8.394400000000001, 12.0, 8.394400000000001]_10_v2.pkl.gz",
    "3517_[8.394400000000001, 12.0, 8.394400000000001]_20_v2.pkl.gz",
    "3517_[8.394400000000001, 12.0, 8.394400000000001]_30_v2.pkl.gz",
    "3517_[8.394400000000001, 12.0, 8.394400000000001]_40_v2.pkl.gz",
    "3517_[8.548, 12.0, 8.548]_10_v2.pkl.gz",
    "3517_[8.548, 12.0, 8.548]_20_v2.pkl.gz",
    "3517_[8.548, 12.0, 8.548]_30_v2.pkl.gz",
    "3517_[8.548, 12.0, 8.548]_40_v2.pkl.gz",
    "3517_[8.5824, 10.8, 7.8264]_10_v2.pkl.gz",
    "3517_[8.5824, 10.8, 7.8264]_20_v2.pkl.gz",
    "3517_[8.5824, 10.8, 7.8264]_30_v2.pkl.gz",
    "3517_[8.64, 12.0, 8.64]_10_v2.pkl.gz",
    "3517_[8.64, 12.0, 8.64]_20_v2.pkl.gz",
    "3517_[8.64, 12.0, 8.64]_30_v2.pkl.gz",
    "3517_[8.64, 12.0, 8.64]_40_v2.pkl.gz",
    "3517_[8.727200000000002, 12.0, 8.727200000000002]_10_v2.pkl.gz",
    "3517_[8.727200000000002, 12.0, 8.727200000000002]_20_v2.pkl.gz",
    "3517_[8.727200000000002, 12.0, 8.727200000000002]_30_v2.pkl.gz",
    "3517_[8.727200000000002, 12.0, 8.727200000000002]_40_v2.pkl.gz",
    "3517_[8.812000000000001, 12.0, 8.812000000000001]_10_v2.pkl.gz",
    "3517_[8.812000000000001, 12.0, 8.812000000000001]_20_v2.pkl.gz",
    "3517_[8.812000000000001, 12.0, 8.812000000000001]_30_v2.pkl.gz",
    "3517_[8.812000000000001, 12.0, 8.812000000000001]_40_v2.pkl.gz",
    "3517_[9.1584, 12.0, 9.1584]_10_v2.pkl.gz",
    "3517_[9.1584, 12.0, 9.1584]_20_v2.pkl.gz",
    "3517_[9.1584, 12.0, 9.1584]_30_v2.pkl.gz",
    "3517_[9.36, 9.36, 9.36]_10_v2.pkl.gz",
    "3517_[9.36, 9.36, 9.36]_20_v2.pkl.gz",
    "3517_[9.36, 9.36, 9.36]_30_v2.pkl.gz",
    "3519_[4.324000000000001, 12.0, 4.324000000000001]_10_v2.pkl.gz",
    "3519_[4.324000000000001, 12.0, 4.324000000000001]_20_v2.pkl.gz",
    "3519_[4.324000000000001, 12.0, 4.324000000000001]_30_v2.pkl.gz",
    "3519_[4.324000000000001, 12.0, 4.324000000000001]_40_v2.pkl.gz",
    "3519_[4.572, 12.0, 4.572]_10_v2.pkl.gz",
    "3519_[4.572, 12.0, 4.572]_20_v2.pkl.gz",
    "3519_[4.572, 12.0, 4.572]_30_v2.pkl.gz",
    "3519_[4.6576, 12.0, 4.6576]_10_v2.pkl.gz",
    "3519_[4.6576, 12.0, 4.6576]_20_v2.pkl.gz",
    "3519_[4.6576, 12.0, 4.6576]_30_v2.pkl.gz",
    "3519_[4.6576, 12.0, 4.6576]_40_v2.pkl.gz",
    "3519_[4.704, 12.0, 4.704]_10_v2.pkl.gz",
    "3519_[4.704, 12.0, 4.704]_20_v2.pkl.gz",
    "3519_[4.704, 12.0, 4.704]_30_v2.pkl.gz",
    "3519_[4.9416, 12.0, 4.9416]_10_v2.pkl.gz",
    "3519_[4.9416, 12.0, 4.9416]_20_v2.pkl.gz",
    "3519_[4.9416, 12.0, 4.9416]_30_v2.pkl.gz",
    "3519_[4.9416, 12.0, 4.9416]_40_v2.pkl.gz",
    "3519_[4.961600000000001, 12.0, 4.961600000000001]_10_v2.pkl.gz",
    "3519_[4.961600000000001, 12.0, 4.961600000000001]_20_v2.pkl.gz",
    "3519_[4.961600000000001, 12.0, 4.961600000000001]_30_v2.pkl.gz",
    "3519_[4.961600000000001, 12.0, 4.961600000000001]_40_v2.pkl.gz",
    "3519_[5.164000000000001, 12.0, 5.164000000000001]_10_v2.pkl.gz",
    "3519_[5.164000000000001, 12.0, 5.164000000000001]_20_v2.pkl.gz",
    "3519_[5.164000000000001, 12.0, 5.164000000000001]_30_v2.pkl.gz",
    "3519_[5.164000000000001, 12.0, 5.164000000000001]_40_v2.pkl.gz",
    "3519_[5.639200000000001, 12.0, 5.639200000000001]_10_v2.pkl.gz",
    "3519_[5.639200000000001, 12.0, 5.639200000000001]_20_v2.pkl.gz",
    "3519_[5.639200000000001, 12.0, 5.639200000000001]_30_v2.pkl.gz",
    "3519_[5.639200000000001, 12.0, 5.639200000000001]_40_v2.pkl.gz",
    "3520_[3.9936000000000003, 12.0, 3.9936000000000003]_10_v2.pkl.gz",
    "3520_[3.9936000000000003, 12.0, 3.9936000000000003]_20_v2.pkl.gz",
    "3520_[3.9936000000000003, 12.0, 3.9936000000000003]_30_v2.pkl.gz",
    "3520_[4.598400000000001, 12.0, 4.598400000000001]_10_v2.pkl.gz",
    "3520_[4.598400000000001, 12.0, 4.598400000000001]_20_v2.pkl.gz",
    "3520_[4.598400000000001, 12.0, 4.598400000000001]_30_v2.pkl.gz",
    "3520_[4.598400000000001, 12.0, 4.598400000000001]_40_v2.pkl.gz",
    "3520_[4.644, 10.2136, 4.644]_10_v2.pkl.gz",
    "3520_[4.644, 10.2136, 4.644]_20_v2.pkl.gz",
    "3520_[4.644, 10.2136, 4.644]_30_v2.pkl.gz",
    "3520_[4.644, 10.2136, 4.644]_40_v2.pkl.gz",
    "3520_[4.8192, 9.6736, 4.8192]_10_v2.pkl.gz",
    "3520_[4.8192, 9.6736, 4.8192]_20_v2.pkl.gz",
    "3520_[4.8192, 9.6736, 4.8192]_30_v2.pkl.gz",
    "3520_[4.8192, 9.6736, 4.8192]_40_v2.pkl.gz",
    "3520_[4.8856, 12.0, 4.8856]_10_v2.pkl.gz",
    "3520_[4.8856, 12.0, 4.8856]_20_v2.pkl.gz",
    "3520_[4.8856, 12.0, 4.8856]_30_v2.pkl.gz",
    "3520_[4.8856, 12.0, 4.8856]_40_v2.pkl.gz",
    "3520_[4.913600000000001, 12.0, 4.913600000000001]_10_v2.pkl.gz",
    "3520_[4.913600000000001, 12.0, 4.913600000000001]_20_v2.pkl.gz",
    "3520_[4.913600000000001, 12.0, 4.913600000000001]_30_v2.pkl.gz",
    "3520_[4.913600000000001, 12.0, 4.913600000000001]_40_v2.pkl.gz",
    "3520_[4.9632000000000005, 12.0, 4.9632000000000005]_10_v2.pkl.gz",
    "3520_[4.9632000000000005, 12.0, 4.9632000000000005]_20_v2.pkl.gz",
    "3520_[4.9632000000000005, 12.0, 4.9632000000000005]_30_v2.pkl.gz",
    "3520_[4.9632000000000005, 12.0, 4.9632000000000005]_40_v2.pkl.gz",
    "3520_[4.9888, 12.0, 4.9888]_10_v2.pkl.gz",
    "3520_[4.9888, 12.0, 4.9888]_20_v2.pkl.gz",
    "3520_[4.9888, 12.0, 4.9888]_30_v2.pkl.gz",
    "3520_[4.9888, 12.0, 4.9888]_40_v2.pkl.gz",
    "3520_[5.104, 8.388, 5.104]_10_v2.pkl.gz",
    "3520_[5.104, 8.388, 5.104]_20_v2.pkl.gz",
    "3520_[5.104, 8.388, 5.104]_30_v2.pkl.gz",
    "3520_[5.104, 8.388, 5.104]_40_v2.pkl.gz",
    "3520_[5.3856, 12.0, 5.3856]_10_v2.pkl.gz",
    "3520_[5.3856, 12.0, 5.3856]_20_v2.pkl.gz",
    "3520_[5.3856, 12.0, 5.3856]_30_v2.pkl.gz",
    "3520_[5.3856, 12.0, 5.3856]_40_v2.pkl.gz",
    "3558_[12.0, 12.0, 12.0]_10_v2.pkl.gz",
    "3558_[12.0, 12.0, 12.0]_20_v2.pkl.gz",
    "3558_[12.0, 12.0, 12.0]_30_v2.pkl.gz",
    "3558_[12.0, 12.0, 12.0]_40_v2.pkl.gz",
    "3571_[12.0, 12.0, 12.0]_10_v2.pkl.gz",
    "3571_[12.0, 12.0, 12.0]_20_v2.pkl.gz",
    "3571_[12.0, 12.0, 12.0]_30_v2.pkl.gz",
    "3571_[12.0, 12.0, 12.0]_40_v2.pkl.gz",
    "3574_[10.2864, 12.0, 10.2864]_10_v2.pkl.gz",
    "3574_[10.2864, 12.0, 10.2864]_20_v2.pkl.gz",
    "3574_[10.2864, 12.0, 10.2864]_30_v2.pkl.gz",
    "3574_[10.2864, 12.0, 10.2864]_40_v2.pkl.gz",
    "3574_[10.599200000000002, 12.0, 10.599200000000002]_10_v2.pkl.gz",
    "3574_[10.599200000000002, 12.0, 10.599200000000002]_20_v2.pkl.gz",
    "3574_[10.599200000000002, 12.0, 10.599200000000002]_30_v2.pkl.gz",
    "3574_[10.599200000000002, 12.0, 10.599200000000002]_40_v2.pkl.gz",
    "3574_[10.752, 12.0, 10.752]_10_v2.pkl.gz",
    "3574_[10.752, 12.0, 10.752]_20_v2.pkl.gz",
    "3574_[10.752, 12.0, 10.752]_30_v2.pkl.gz",
    "3574_[10.752, 12.0, 10.752]_40_v2.pkl.gz",
    "3574_[10.858400000000001, 12.0, 10.858400000000001]_10_v2.pkl.gz",
    "3574_[10.858400000000001, 12.0, 10.858400000000001]_20_v2.pkl.gz",
    "3574_[10.858400000000001, 12.0, 10.858400000000001]_30_v2.pkl.gz",
    "3574_[10.858400000000001, 12.0, 10.858400000000001]_40_v2.pkl.gz",
    "3574_[11.4512, 12.0, 11.4512]_10_v2.pkl.gz",
    "3574_[11.4512, 12.0, 11.4512]_20_v2.pkl.gz",
    "3574_[11.4512, 12.0, 11.4512]_30_v2.pkl.gz",
    "3574_[11.4512, 12.0, 11.4512]_40_v2.pkl.gz",
    "3574_[11.465600000000002, 12.0, 11.465600000000002]_10_v2.pkl.gz",
    "3574_[11.465600000000002, 12.0, 11.465600000000002]_20_v2.pkl.gz",
    "3574_[11.465600000000002, 12.0, 11.465600000000002]_30_v2.pkl.gz",
    "3574_[11.465600000000002, 12.0, 11.465600000000002]_40_v2.pkl.gz",
    "3574_[12.0, 12.0, 12.0]_10_v2.pkl.gz",
    "3574_[12.0, 12.0, 12.0]_20_v2.pkl.gz",
    "3574_[12.0, 12.0, 12.0]_30_v2.pkl.gz",
    "3574_[8.8224, 12.0, 8.8224]_10_v2.pkl.gz",
    "3574_[8.8224, 12.0, 8.8224]_20_v2.pkl.gz",
    "3574_[8.8224, 12.0, 8.8224]_30_v2.pkl.gz",
    "3574_[9.276000000000002, 12.0, 9.276000000000002]_10_v2.pkl.gz",
    "3574_[9.276000000000002, 12.0, 9.276000000000002]_20_v2.pkl.gz",
    "3574_[9.276000000000002, 12.0, 9.276000000000002]_30_v2.pkl.gz",
    "3574_[9.276000000000002, 12.0, 9.276000000000002]_40_v2.pkl.gz",
    "3574_[9.507200000000001, 12.0, 9.507200000000001]_10_v2.pkl.gz",
    "3574_[9.507200000000001, 12.0, 9.507200000000001]_20_v2.pkl.gz",
    "3574_[9.507200000000001, 12.0, 9.507200000000001]_30_v2.pkl.gz",
    "3574_[9.5776, 12.0, 9.5776]_10_v2.pkl.gz",
    "3574_[9.5776, 12.0, 9.5776]_20_v2.pkl.gz",
    "3574_[9.5776, 12.0, 9.5776]_30_v2.pkl.gz",
    "3574_[9.5776, 12.0, 9.5776]_40_v2.pkl.gz",
    "3574_[9.889600000000002, 12.0, 9.889600000000002]_10_v2.pkl.gz",
    "3574_[9.889600000000002, 12.0, 9.889600000000002]_20_v2.pkl.gz",
    "3574_[9.889600000000002, 12.0, 9.889600000000002]_30_v2.pkl.gz",
    "3574_[9.889600000000002, 12.0, 9.889600000000002]_40_v2.pkl.gz",
    "3574_[9.924, 12.0, 9.924]_10_v2.pkl.gz",
    "3574_[9.924, 12.0, 9.924]_20_v2.pkl.gz",
    "3574_[9.924, 12.0, 9.924]_30_v2.pkl.gz",
    "3574_[9.924, 12.0, 9.924]_40_v2.pkl.gz",
    "3574_[9.9984, 12.0, 9.9984]_10_v2.pkl.gz",
    "3574_[9.9984, 12.0, 9.9984]_20_v2.pkl.gz",
    "3574_[9.9984, 12.0, 9.9984]_30_v2.pkl.gz",
    "3574_[9.9984, 12.0, 9.9984]_40_v2.pkl.gz",
    "3593_[12.0, 12.0, 12.0]_10_v2.pkl.gz",
    "3593_[12.0, 12.0, 12.0]_20_v2.pkl.gz",
    "3593_[12.0, 12.0, 12.0]_30_v2.pkl.gz",
    "3596_[3.9968000000000004, 5.581600000000001, 3.9968000000000004]_20_v2.pkl.gz",
    "3596_[5.088000000000001, 11.3816, 5.088000000000001]_10_v2.pkl.gz",
    "3596_[5.088000000000001, 11.3816, 5.088000000000001]_20_v2.pkl.gz",
    "3596_[5.088000000000001, 11.3816, 5.088000000000001]_30_v2.pkl.gz",
    "3596_[5.7168, 6.96, 5.7168]_10_v2.pkl.gz",
    "3596_[5.7168, 6.96, 5.7168]_20_v2.pkl.gz",
    "3596_[5.7168, 6.96, 5.7168]_30_v2.pkl.gz",
    "3596_[6.0360000000000005, 7.32, 6.0360000000000005]_10_v2.pkl.gz",
    "3596_[6.0360000000000005, 7.32, 6.0360000000000005]_20_v2.pkl.gz",
    "3596_[6.0360000000000005, 7.32, 6.0360000000000005]_30_v2.pkl.gz",
    "3596_[6.1112, 7.955200000000001, 6.1112]_10_v2.pkl.gz",
    "3596_[6.1112, 7.955200000000001, 6.1112]_20_v2.pkl.gz",
    "3596_[6.1112, 7.955200000000001, 6.1112]_30_v2.pkl.gz",
    "3596_[6.2336, 9.204, 6.2336]_10_v2.pkl.gz",
    "3596_[6.2336, 9.204, 6.2336]_20_v2.pkl.gz",
    "3596_[6.2336, 9.204, 6.2336]_30_v2.pkl.gz",
    "3596_[6.312, 12.0, 6.312]_10_v2.pkl.gz",
    "3596_[6.312, 12.0, 6.312]_20_v2.pkl.gz",
    "3596_[6.312, 12.0, 6.312]_30_v2.pkl.gz",
    "3596_[6.6624, 9.3624, 6.6624]_10_v2.pkl.gz",
    "3596_[6.6624, 9.3624, 6.6624]_20_v2.pkl.gz",
    "3596_[6.6624, 9.3624, 6.6624]_30_v2.pkl.gz",
    "3596_[6.7408, 12.0, 6.7408]_10_v2.pkl.gz",
    "3596_[6.7408, 12.0, 6.7408]_20_v2.pkl.gz",
    "3596_[6.7408, 12.0, 6.7408]_30_v2.pkl.gz",
    # ... include the rest of your filenames here
]

# Generate a dictionary of config classes keyed by their class name.
for filename in json_filenames:
    object_id = filename.split("_")[0]
    scale = filename.split("_")[1].strip("[]")
    scale = [float(val) for val in scale.split(",")]
    target = filename.split("_")[2]
    code = f"""@configclass
class ArnoldPickupObject{object_id}{get_scale_friendly_name(scale)}{target}MetaCfg(ArnoldTaskMetaCfg):
    episode_length = 1600
    try_add_table = False
    decimation = 1

    traj_filepath = "roboverse_data/assets/arnold/pickup_object_merged_pickle/{filename}"
    object_usd_path = "roboverse_data/assets/arnold/sample/custom/Bottle/{object_id}/mobility.usd"
    scale = {scale}
    target = {target}

    def __post_init__(self):
        scale = [s * 0.01 for s in self.scale]

        # cm to m
        target = float(self.target) * 0.01

        self.objects = [
            RigidObjMetaCfg(
                name="Bottle",
                usd_path=self.object_usd_path,
                physics=PhysicStateType.RIGIDBODY,
                scale=scale,
            ),
        ]

        self.checker = PositionShiftCheckerWithTolerance(
            obj_name="Bottle",
            axis="z",
            distance=target,
            tolerance=0.03,
        )

        self.robot = FrankaMetaCfg(
            name="franka",
        )
"""
    exec(code)


# Now, if you list __all__, you can include all the generated names so that
# "from .arnold.arnold_pickup_object import *" only imports these.
__all__ = [name for name in globals() if name.startswith("ArnoldPickupObject")]
